<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.24">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>mini.test documentation – MINI</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../..//assets/logo-mini_180x180.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-0ed1a58f1961f20e100ea025a42ebf64.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-fdc1b2fd0a2d1e1fd2f41bfe1f0ec5c1.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-deb52f76cf1f38a7748e513572c41f9a.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-fc10660e286e6ab0b07026e33ebb6568.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": "tree",
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style> .quarto-title > h1.title { display: none } </style>


<meta property="og:title" content="mini.test documentation – MINI">
<meta property="og:description" content="Modular Independent Neovim Improvements">
<meta property="og:image" content="https://nvim-mini.org/assets/logo-mini_social.png">
<meta property="og:site_name" content="MINI">
<meta property="og:image:height" content="630">
<meta property="og:image:width" content="1200">
<meta name="twitter:title" content="mini.test documentation – MINI">
<meta name="twitter:description" content="Modular Independent Neovim Improvements">
<meta name="twitter:image" content="https://nvim-mini.org/assets/logo-mini_social.png">
<meta name="twitter:image-height" content="630">
<meta name="twitter:image-width" content="1200">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed quarto-dark"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = true;
    const queryPrefersDark = window.matchMedia('(prefers-color-scheme: dark)');
    const darkModeDefault = queryPrefersDark.matches;
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    queryPrefersDark.addEventListener("change", e => {
      if(window.localStorage.getItem("quarto-color-scheme") !== null)
        return;
      const alternate = e.matches
      toggleColorMode(alternate);
      localAlternateSentinel = e.matches ? 'alternate' : 'default'; // this is used alongside local storage!
      toggleGiscusIfUsed(alternate, darkModeDefault);
    });
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">MINI</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../mini.nvim/index.html"> 
<span class="menu-text">mini.nvim</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../MiniMax/index.html"> 
<span class="menu-text">MiniMax</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog/index.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/nvim-mini"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../blog/index.xml"> <i class="bi bi-rss-fill" role="img" aria-label="RSS">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#module" id="toc-module" class="nav-link active" data-scroll-target="#module">Module</a>
  <ul>
  <li><a href="#module-workflow" id="toc-module-workflow" class="nav-link" data-scroll-target="#module-workflow">Workflow</a></li>
  <li><a href="#module-setup" id="toc-module-setup" class="nav-link" data-scroll-target="#module-setup">Setup</a></li>
  <li><a href="#module-comparisons" id="toc-module-comparisons" class="nav-link" data-scroll-target="#module-comparisons">Comparisons</a></li>
  <li><a href="#module-highlightgroups" id="toc-module-highlightgroups" class="nav-link" data-scroll-target="#module-highlightgroups">Highlight groups</a></li>
  <li><a href="#module-disabling" id="toc-module-disabling" class="nav-link" data-scroll-target="#module-disabling">Disabling</a></li>
  </ul></li>
  <li><a href="#minitest.setup" id="toc-minitest.setup" class="nav-link" data-scroll-target="#minitest.setup">setup()</a>
  <ul>
  <li><a href="#minitest.setup-parameters" id="toc-minitest.setup-parameters" class="nav-link" data-scroll-target="#minitest.setup-parameters">Parameters</a></li>
  <li><a href="#minitest.setup-usage" id="toc-minitest.setup-usage" class="nav-link" data-scroll-target="#minitest.setup-usage">Usage</a></li>
  </ul></li>
  <li><a href="#minitest.config" id="toc-minitest.config" class="nav-link" data-scroll-target="#minitest.config">config</a>
  <ul>
  <li><a href="#minitest.config-defaults" id="toc-minitest.config-defaults" class="nav-link" data-scroll-target="#minitest.config-defaults">Defaults</a></li>
  </ul></li>
  <li><a href="#minitest.current" id="toc-minitest.current" class="nav-link" data-scroll-target="#minitest.current">current</a></li>
  <li><a href="#minitest.new_set" id="toc-minitest.new_set" class="nav-link" data-scroll-target="#minitest.new_set">new_set()</a>
  <ul>
  <li><a href="#minitest.new_set-parameters" id="toc-minitest.new_set-parameters" class="nav-link" data-scroll-target="#minitest.new_set-parameters">Parameters</a></li>
  <li><a href="#minitest.new_set-return" id="toc-minitest.new_set-return" class="nav-link" data-scroll-target="#minitest.new_set-return">Return</a></li>
  <li><a href="#minitest.new_set-usage" id="toc-minitest.new_set-usage" class="nav-link" data-scroll-target="#minitest.new_set-usage">Usage</a></li>
  </ul></li>
  <li><a href="#minitest-test-case" id="toc-minitest-test-case" class="nav-link" data-scroll-target="#minitest-test-case">Test case</a>
  <ul>
  <li><a href="#minitest-test-case-class" id="toc-minitest-test-case-class" class="nav-link" data-scroll-target="#minitest-test-case-class">Class</a></li>
  <li><a href="#minitest-test-case-fields" id="toc-minitest-test-case-fields" class="nav-link" data-scroll-target="#minitest-test-case-fields">Fields</a></li>
  </ul></li>
  <li><a href="#minitest.skip" id="toc-minitest.skip" class="nav-link" data-scroll-target="#minitest.skip">skip()</a>
  <ul>
  <li><a href="#minitest.skip-parameters" id="toc-minitest.skip-parameters" class="nav-link" data-scroll-target="#minitest.skip-parameters">Parameters</a></li>
  </ul></li>
  <li><a href="#minitest.add_note" id="toc-minitest.add_note" class="nav-link" data-scroll-target="#minitest.add_note">add_note()</a>
  <ul>
  <li><a href="#minitest.add_note-parameters" id="toc-minitest.add_note-parameters" class="nav-link" data-scroll-target="#minitest.add_note-parameters">Parameters</a></li>
  </ul></li>
  <li><a href="#minitest.finally" id="toc-minitest.finally" class="nav-link" data-scroll-target="#minitest.finally">finally()</a>
  <ul>
  <li><a href="#minitest.finally-parameters" id="toc-minitest.finally-parameters" class="nav-link" data-scroll-target="#minitest.finally-parameters">Parameters</a></li>
  </ul></li>
  <li><a href="#minitest.run" id="toc-minitest.run" class="nav-link" data-scroll-target="#minitest.run">run()</a>
  <ul>
  <li><a href="#minitest.run-parameters" id="toc-minitest.run-parameters" class="nav-link" data-scroll-target="#minitest.run-parameters">Parameters</a></li>
  </ul></li>
  <li><a href="#minitest.run_file" id="toc-minitest.run_file" class="nav-link" data-scroll-target="#minitest.run_file">run_file()</a>
  <ul>
  <li><a href="#minitest.run_file-parameters" id="toc-minitest.run_file-parameters" class="nav-link" data-scroll-target="#minitest.run_file-parameters">Parameters</a></li>
  </ul></li>
  <li><a href="#minitest.run_at_location" id="toc-minitest.run_at_location" class="nav-link" data-scroll-target="#minitest.run_at_location">run_at_location()</a>
  <ul>
  <li><a href="#minitest.run_at_location-parameters" id="toc-minitest.run_at_location-parameters" class="nav-link" data-scroll-target="#minitest.run_at_location-parameters">Parameters</a></li>
  </ul></li>
  <li><a href="#minitest.collect" id="toc-minitest.collect" class="nav-link" data-scroll-target="#minitest.collect">collect()</a>
  <ul>
  <li><a href="#minitest.collect-parameters" id="toc-minitest.collect-parameters" class="nav-link" data-scroll-target="#minitest.collect-parameters">Parameters</a></li>
  <li><a href="#minitest.collect-return" id="toc-minitest.collect-return" class="nav-link" data-scroll-target="#minitest.collect-return">Return</a></li>
  </ul></li>
  <li><a href="#minitest.execute" id="toc-minitest.execute" class="nav-link" data-scroll-target="#minitest.execute">execute()</a>
  <ul>
  <li><a href="#minitest.execute-parameters" id="toc-minitest.execute-parameters" class="nav-link" data-scroll-target="#minitest.execute-parameters">Parameters</a></li>
  </ul></li>
  <li><a href="#minitest.stop" id="toc-minitest.stop" class="nav-link" data-scroll-target="#minitest.stop">stop()</a>
  <ul>
  <li><a href="#minitest.stop-parameters" id="toc-minitest.stop-parameters" class="nav-link" data-scroll-target="#minitest.stop-parameters">Parameters</a></li>
  </ul></li>
  <li><a href="#minitest.is_executing" id="toc-minitest.is_executing" class="nav-link" data-scroll-target="#minitest.is_executing">is_executing()</a>
  <ul>
  <li><a href="#minitest.is_executing-return" id="toc-minitest.is_executing-return" class="nav-link" data-scroll-target="#minitest.is_executing-return">Return</a></li>
  </ul></li>
  <li><a href="#minitest.expect" id="toc-minitest.expect" class="nav-link" data-scroll-target="#minitest.expect">expect</a>
  <ul>
  <li><a href="#minitest.expect-usage" id="toc-minitest.expect-usage" class="nav-link" data-scroll-target="#minitest.expect-usage">Usage</a></li>
  </ul></li>
  <li><a href="#minitest.expect.equality" id="toc-minitest.expect.equality" class="nav-link" data-scroll-target="#minitest.expect.equality">expect.equality()</a>
  <ul>
  <li><a href="#minitest.expect.equality-parameters" id="toc-minitest.expect.equality-parameters" class="nav-link" data-scroll-target="#minitest.expect.equality-parameters">Parameters</a></li>
  </ul></li>
  <li><a href="#minitest.expect.no_equality" id="toc-minitest.expect.no_equality" class="nav-link" data-scroll-target="#minitest.expect.no_equality">expect.no_equality()</a>
  <ul>
  <li><a href="#minitest.expect.no_equality-parameters" id="toc-minitest.expect.no_equality-parameters" class="nav-link" data-scroll-target="#minitest.expect.no_equality-parameters">Parameters</a></li>
  </ul></li>
  <li><a href="#minitest.expect.error" id="toc-minitest.expect.error" class="nav-link" data-scroll-target="#minitest.expect.error">expect.error()</a>
  <ul>
  <li><a href="#minitest.expect.error-parameters" id="toc-minitest.expect.error-parameters" class="nav-link" data-scroll-target="#minitest.expect.error-parameters">Parameters</a></li>
  </ul></li>
  <li><a href="#minitest.expect.no_error" id="toc-minitest.expect.no_error" class="nav-link" data-scroll-target="#minitest.expect.no_error">expect.no_error()</a>
  <ul>
  <li><a href="#minitest.expect.no_error-parameters" id="toc-minitest.expect.no_error-parameters" class="nav-link" data-scroll-target="#minitest.expect.no_error-parameters">Parameters</a></li>
  </ul></li>
  <li><a href="#minitest.expect.reference_screenshot" id="toc-minitest.expect.reference_screenshot" class="nav-link" data-scroll-target="#minitest.expect.reference_screenshot">expect.reference_screenshot()</a>
  <ul>
  <li><a href="#minitest.expect.reference_screenshot-parameters" id="toc-minitest.expect.reference_screenshot-parameters" class="nav-link" data-scroll-target="#minitest.expect.reference_screenshot-parameters">Parameters</a></li>
  </ul></li>
  <li><a href="#minitest.new_expectation" id="toc-minitest.new_expectation" class="nav-link" data-scroll-target="#minitest.new_expectation">new_expectation()</a>
  <ul>
  <li><a href="#minitest.new_expectation-parameters" id="toc-minitest.new_expectation-parameters" class="nav-link" data-scroll-target="#minitest.new_expectation-parameters">Parameters</a></li>
  <li><a href="#minitest.new_expectation-return" id="toc-minitest.new_expectation-return" class="nav-link" data-scroll-target="#minitest.new_expectation-return">Return</a></li>
  <li><a href="#minitest.new_expectation-usage" id="toc-minitest.new_expectation-usage" class="nav-link" data-scroll-target="#minitest.new_expectation-usage">Usage</a></li>
  </ul></li>
  <li><a href="#minitest.gen_reporter" id="toc-minitest.gen_reporter" class="nav-link" data-scroll-target="#minitest.gen_reporter">gen_reporter</a></li>
  <li><a href="#minitest.gen_reporter.buffer" id="toc-minitest.gen_reporter.buffer" class="nav-link" data-scroll-target="#minitest.gen_reporter.buffer">gen_reporter.buffer()</a>
  <ul>
  <li><a href="#minitest.gen_reporter.buffer-parameters" id="toc-minitest.gen_reporter.buffer-parameters" class="nav-link" data-scroll-target="#minitest.gen_reporter.buffer-parameters">Parameters</a></li>
  </ul></li>
  <li><a href="#minitest.gen_reporter.stdout" id="toc-minitest.gen_reporter.stdout" class="nav-link" data-scroll-target="#minitest.gen_reporter.stdout">gen_reporter.stdout()</a>
  <ul>
  <li><a href="#minitest.gen_reporter.stdout-parameters" id="toc-minitest.gen_reporter.stdout-parameters" class="nav-link" data-scroll-target="#minitest.gen_reporter.stdout-parameters">Parameters</a></li>
  </ul></li>
  <li><a href="#minitest.new_child_neovim" id="toc-minitest.new_child_neovim" class="nav-link" data-scroll-target="#minitest.new_child_neovim">new_child_neovim()</a>
  <ul>
  <li><a href="#minitest.new_child_neovim-return" id="toc-minitest.new_child_neovim-return" class="nav-link" data-scroll-target="#minitest.new_child_neovim-return">Return</a></li>
  <li><a href="#minitest.new_child_neovim-usage" id="toc-minitest.new_child_neovim-usage" class="nav-link" data-scroll-target="#minitest.new_child_neovim-usage">Usage</a></li>
  </ul></li>
  <li><a href="#minitest-child-neovim" id="toc-minitest-child-neovim" class="nav-link" data-scroll-target="#minitest-child-neovim">Child neovim</a>
  <ul>
  <li><a href="#minitest-child-neovim-class" id="toc-minitest-child-neovim-class" class="nav-link" data-scroll-target="#minitest-child-neovim-class">Class</a></li>
  <li><a href="#minitest-child-neovim-fields" id="toc-minitest-child-neovim-fields" class="nav-link" data-scroll-target="#minitest-child-neovim-fields">Fields</a></li>
  </ul></li>
  <li><a href="#minitest-child-neovim-start" id="toc-minitest-child-neovim-start" class="nav-link" data-scroll-target="#minitest-child-neovim-start">Child neovim start()</a>
  <ul>
  <li><a href="#minitest-child-neovim-start-parameters" id="toc-minitest-child-neovim-start-parameters" class="nav-link" data-scroll-target="#minitest-child-neovim-start-parameters">Parameters</a></li>
  <li><a href="#minitest-child-neovim-start-usage" id="toc-minitest-child-neovim-start-usage" class="nav-link" data-scroll-target="#minitest-child-neovim-start-usage">Usage</a></li>
  </ul></li>
  <li><a href="#minitest-child-neovim-type_keys" id="toc-minitest-child-neovim-type_keys" class="nav-link" data-scroll-target="#minitest-child-neovim-type_keys">Child neovim type_keys()</a>
  <ul>
  <li><a href="#minitest-child-neovim-type_keys-parameters" id="toc-minitest-child-neovim-type_keys-parameters" class="nav-link" data-scroll-target="#minitest-child-neovim-type_keys-parameters">Parameters</a></li>
  <li><a href="#minitest-child-neovim-type_keys-usage" id="toc-minitest-child-neovim-type_keys-usage" class="nav-link" data-scroll-target="#minitest-child-neovim-type_keys-usage">Usage</a></li>
  </ul></li>
  <li><a href="#minitest-child-neovim-get_screenshot" id="toc-minitest-child-neovim-get_screenshot" class="nav-link" data-scroll-target="#minitest-child-neovim-get_screenshot">Child neovim get_screenshot()</a>
  <ul>
  <li><a href="#minitest-child-neovim-get_screenshot-parameters" id="toc-minitest-child-neovim-get_screenshot-parameters" class="nav-link" data-scroll-target="#minitest-child-neovim-get_screenshot-parameters">Parameters</a></li>
  <li><a href="#minitest-child-neovim-get_screenshot-return" id="toc-minitest-child-neovim-get_screenshot-return" class="nav-link" data-scroll-target="#minitest-child-neovim-get_screenshot-return">Return</a></li>
  <li><a href="#minitest-child-neovim-get_screenshot-usage" id="toc-minitest-child-neovim-get_screenshot-usage" class="nav-link" data-scroll-target="#minitest-child-neovim-get_screenshot-usage">Usage</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">mini.test documentation</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><em>Generated from the <code>main</code> branch of ‘mini.nvim’</em></p>
<p><a name="mini.test" href="../../mini.nvim/doc/mini-test.html#mini.test"><b>mini.test</b></a> Test Neovim plugins</p>
<p>MIT License Copyright (c) 2022 Evgeni Chasnovski</p>
<hr>
<section id="module" class="level3 help-syntax-right-anchor">
<h3 class="help-syntax-right-anchor anchored" data-anchor-id="module">Module</h3>
<p>Features:</p>
<ul>
<li><p>Test action is defined as a named callable entry of a table.</p></li>
<li><p>Helper for creating child Neovim process which is designed to be used in tests (including taking and verifying screenshots). See <a href="../../mini.nvim/doc/mini-test.html#minitest.new_child_neovim">MiniTest.new_child_neovim()</a> and <a href="../../mini.nvim/doc/mini-test.html#minitest.expect.reference_screenshot">MiniTest.expect.reference_screenshot()</a>.</p></li>
<li><p>Hierarchical organization of tests with custom hooks, parametrization, and user data. See <a href="../../mini.nvim/doc/mini-test.html#minitest.new_set">MiniTest.new_set()</a>.</p></li>
<li><p>Emulation of <a href="https://github.com/lunarmodules/busted">lunarmodules/busted</a> interface (<code>describe</code>, <code>it</code>, etc.).</p></li>
<li><p>Predefined small yet usable set of expectations (<code>assert</code>-like functions). See <a href="../../mini.nvim/doc/mini-test.html#minitest.expect">MiniTest.expect</a>.</p></li>
<li><p>Customizable definition of what files should be tested.</p></li>
<li><p>Test case filtering. There are predefined wrappers for testing a file (<a href="../../mini.nvim/doc/mini-test.html#minitest.run_file">MiniTest.run_file()</a>) and case at a location like current cursor position (<a href="../../mini.nvim/doc/mini-test.html#minitest.run_at_location">MiniTest.run_at_location()</a>).</p></li>
<li><p>Customizable reporter of output results. There are two predefined ones:</p>
<ul>
<li><p><a href="../../mini.nvim/doc/mini-test.html#minitest.gen_reporter.buffer">MiniTest.gen_reporter.buffer()</a> for interactive usage.</p></li>
<li><p><a href="../../mini.nvim/doc/mini-test.html#minitest.gen_reporter.stdout">MiniTest.gen_reporter.stdout()</a> for headless Neovim.</p></li>
</ul></li>
<li><p>Customizable project specific testing script.</p></li>
<li><p>Works on Unix (Linux, MacOS, etc.) and Windows.</p></li>
</ul>
<p>What it doesn’t support:</p>
<ul>
<li><p>Parallel execution. Due to idea of limiting implementation complexity.</p></li>
<li><p>Mocks, stubs, etc. Use child Neovim process and manually override what is needed. Reset child process it afterwards.</p></li>
<li><p>“Overly specific” expectations. Tests for (no) equality and (absence of) errors usually cover most of the needs. Adding new expectations is a subject to weighing its usefulness against additional implementation complexity. Use <a href="../../mini.nvim/doc/mini-test.html#minitest.new_expectation">MiniTest.new_expectation()</a> to create custom ones.</p></li>
</ul>
<p>For more information see:</p>
<ul>
<li><p>‘TESTING.md’ file for a hands-on introduction based on examples.</p></li>
<li><p>Code of this plugin’s tests. Consider it to be an example of intended way to use ‘mini.test’ for test organization and creation.</p></li>
</ul>
<section id="module-workflow" class="level4">
<h4 class="anchored" data-anchor-id="module-workflow">Workflow</h4>
<ul>
<li><p>Organize tests in separate files. Each test file should return a test set (explicitly or implicitly by using “busted” style functions).</p></li>
<li><p>Write test actions as callable entries of test set. Use child process inside test actions (see <a href="../../mini.nvim/doc/mini-test.html#minitest.new_child_neovim">MiniTest.new_child_neovim()</a>) and builtin expectations (see <a href="../../mini.nvim/doc/mini-test.html#minitest.expect">MiniTest.expect</a>).</p></li>
<li><p>Run tests. This does two steps:</p>
<ul>
<li><p>Collect. This creates single hierarchical test set, flattens into array of test cases (see <a href="../../mini.nvim/doc/mini-test.html#minitest-test-case">MiniTest-test-case</a>) while expanding with parametrization, and possibly filters them.</p></li>
<li><p>Execute. This safely calls hooks and main test actions in specified order while allowing reporting progress in asynchronous fashion. Detected errors means test case fail; otherwise - pass.</p></li>
</ul></li>
</ul>
</section>
<section id="module-setup" class="level4">
<h4 class="anchored" data-anchor-id="module-setup">Setup</h4>
<p>This module needs a setup with <code>require('mini.test').setup({})</code> (replace <code>{}</code> with your <code>config</code> table). It will create global Lua table <code>MiniTest</code> which you can use for scripting or manually (with <code>:lua MiniTest.*</code>).</p>
<p>See <a href="../../mini.nvim/doc/mini-test.html#minitest.config">MiniTest.config</a> for available config settings.</p>
<p>You can override runtime config settings locally to buffer inside <code>vim.b.minitest_config</code> which should have same structure as <code>MiniTest.config</code>. See <a href="../../mini.nvim/doc/mini-nvim.html#mini.nvim-buffer-local-config">mini.nvim-buffer-local-config</a> for more details.</p>
<p>To stop module from showing non-error feedback, set <code>config.silent = true</code>.</p>
</section>
<section id="module-comparisons" class="level4">
<h4 class="anchored" data-anchor-id="module-comparisons">Comparisons</h4>
<ul>
<li><p>Testing infrastructure from <a href="https://github.com/nvim-lua/plenary.nvim">nvim-lua/plenary.nvim</a>:</p>
<ul>
<li><p>Executes each file in separate headless Neovim process with customizable ‘init.vim’ file. While ‘mini.test’ executes everything in current Neovim process encouraging writing tests with help of manually managed child Neovim process (see <a href="../../mini.nvim/doc/mini-test.html#minitest.new_child_neovim">MiniTest.new_child_neovim()</a>).</p></li>
<li><p>Tests are expected to be written with embedded simplified versions of ‘lunarmodules/busted’ and ‘lunarmodules/luassert’. While ‘mini.test’ uses concepts of test set (see <a href="../../mini.nvim/doc/mini-test.html#minitest.new_set">MiniTest.new_set()</a>) and test case (see <a href="../../mini.nvim/doc/mini-test.html#minitest-test-case">MiniTest-test-case</a>). It also can emulate bigger part of “busted” framework.</p></li>
<li><p>Has single way of reporting progress (shows result after every case without summary). While ‘mini.test’ can have customized reporters with defaults for interactive and headless usage (provide more compact and user-friendly summaries).</p></li>
<li><p>Allows parallel execution, while ‘mini.test’ does not.</p></li>
<li><p>Allows making mocks, stubs, and spies, while ‘mini.test’ does not in favor of manually overwriting functionality in child Neovim process.</p></li>
</ul></li>
</ul>
<p>Although ‘mini.test’ supports emulation of “busted style” testing, it will be more stable to use its designed approach of defining tests (with <code>MiniTest.new_set()</code> and explicit table fields). Couple of reasons:</p>
<ul>
<li><p>“Busted” syntax doesn’t support full capabilities offered by ‘mini.test’. Mainly it is about parametrization and supplying user data to test sets.</p></li>
<li><p>It is an emulation, not full support. So some subtle things might not work the way you expect.</p></li>
</ul>
<p>Some hints for converting from ‘plenary.nvim’ tests to ‘mini.test’:</p>
<ul>
<li><p>Rename files from “<em><em>spec.lua” to ”test</em></em>.lua” and put them in “tests” directory.</p></li>
<li><p>Replace <code>assert</code> calls with ‘mini.test’ expectations. See <a href="../../mini.nvim/doc/mini-test.html#minitest.expect">MiniTest.expect</a>.</p></li>
<li><p>Create main test set <code>T = MiniTest.new_set()</code> and eventually return it.</p></li>
<li><p>Make new sets (<a href="../../mini.nvim/doc/mini-test.html#minitest.new_set">MiniTest.new_set()</a>) from <code>describe</code> blocks. Convert <code>before_each()</code> and <code>after_each</code> to <code>pre_case</code> and <code>post_case</code> hooks.</p></li>
<li><p>Make test cases from <code>it</code> blocks.</p></li>
</ul>
</section>
<section id="module-highlightgroups" class="level4">
<h4 class="anchored" data-anchor-id="module-highlightgroups">Highlight groups</h4>
<ul>
<li><p><code>MiniTestEmphasis</code> - emphasis highlighting. By default it is a bold text.</p></li>
<li><p><code>MiniTestFail</code> - highlighting of failed cases. By default it is a bold text with <code>vim.g.terminal_color_1</code> color (red).</p></li>
<li><p><code>MiniTestPass</code> - highlighting of passed cases. By default it is a bold text with <code>vim.g.terminal_color_2</code> color (green).</p></li>
</ul>
<p>To change any highlight group, set it directly with <a href="https://neovim.io/doc/user/helptag.html?tag=nvim_set_hl()">nvim_set_hl()</a>.</p>
</section>
<section id="module-disabling" class="level4">
<h4 class="anchored" data-anchor-id="module-disabling">Disabling</h4>
<p>To disable, set <code>vim.g.minitest_disable</code> (globally) or <code>vim.b.minitest_disable</code> (for a buffer) to <code>true</code>. Considering high number of different scenarios and customization intentions, writing exact rules for disabling module’s functionality is left to user. See <a href="../../mini.nvim/doc/mini-nvim.html#mini.nvim-disabling-recipes">mini.nvim-disabling-recipes</a> for common recipes.</p>
<hr>
</section>
</section>
<section id="minitest.setup" class="level3 help-syntax-right-anchor">
<h3 class="help-syntax-right-anchor anchored" data-anchor-id="minitest.setup">setup()</h3>
<p align="center">
<code>MiniTest.setup</code>(<span class="help-syntax-special">{config}</span>)
</p>
<p>Module setup</p>
<section id="minitest.setup-parameters" class="level4">
<h4 class="anchored" data-anchor-id="minitest.setup-parameters">Parameters</h4>
<p><span class="help-syntax-special">{config}</span> <code>(table|nil)</code> Module config table. See <a href="../../mini.nvim/doc/mini-test.html#minitest.config">MiniTest.config</a>.</p>
</section>
<section id="minitest.setup-usage" class="level4">
<h4 class="anchored" data-anchor-id="minitest.setup-usage">Usage</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="sourceCode lua code-with-copy"><code class="sourceCode lua"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span><span class="op">(</span><span class="st">'mini.test'</span><span class="op">).</span>setup<span class="op">()</span> <span class="co">-- use default config</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">-- OR</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span><span class="op">(</span><span class="st">'mini.test'</span><span class="op">).</span>setup<span class="op">({})</span> <span class="co">-- replace {} with your config table</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
</section>
<section id="minitest.config" class="level3 help-syntax-right-anchor">
<h3 class="help-syntax-right-anchor anchored" data-anchor-id="minitest.config">config</h3>
<p align="center">
<code>MiniTest.config</code>
</p>
<section id="minitest.config-defaults" class="level4">
<h4 class="anchored" data-anchor-id="minitest.config-defaults">Defaults</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="sourceCode lua code-with-copy"><code class="sourceCode lua"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="va">MiniTest</span><span class="op">.</span><span class="va">config</span> <span class="op">=</span> <span class="op">{</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Options for collection of test cases. See `:h MiniTest.collect()`.</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="va">collect</span> <span class="op">=</span> <span class="op">{</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">-- Temporarily emulate functions from 'busted' testing framework</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">-- (`describe`, `it`, `before_each`, `after_each`, and more)</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="va">emulate_busted</span> <span class="op">=</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">-- Function returning array of file paths to be collected.</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">-- Default: all Lua files in 'tests' directory starting with 'test_'.</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="va">find_files</span> <span class="op">=</span> <span class="kw">function</span><span class="op">()</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> <span class="va">vim</span><span class="op">.</span><span class="va">fn</span><span class="op">.</span>globpath<span class="op">(</span><span class="st">'tests'</span><span class="op">,</span> <span class="st">'**/test_*.lua'</span><span class="op">,</span> <span class="kw">true</span><span class="op">,</span> <span class="kw">true</span><span class="op">)</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">end</span><span class="op">,</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">-- Predicate function indicating if test case should be executed</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="va">filter_cases</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">case</span><span class="op">)</span> <span class="cf">return</span> <span class="kw">true</span> <span class="kw">end</span><span class="op">,</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  <span class="op">},</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Options for execution of test cases. See `:h MiniTest.execute()`.</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">execute</span> <span class="op">=</span> <span class="op">{</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">-- Table with callable fields `start()`, `update()`, and `finish()`</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    <span class="va">reporter</span> <span class="op">=</span> <span class="kw">nil</span><span class="op">,</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    <span class="co">-- Whether to stop execution after first error</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    <span class="va">stop_on_error</span> <span class="op">=</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>  <span class="op">},</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Path (relative to current directory) to script which handles project</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- specific test running</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>  <span class="va">script_path</span> <span class="op">=</span> <span class="st">'scripts/minitest.lua'</span><span class="op">,</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Whether to disable showing non-error feedback</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>  <span class="va">silent</span> <span class="op">=</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
</section>
<section id="minitest.current" class="level3 help-syntax-right-anchor">
<h3 class="help-syntax-right-anchor anchored" data-anchor-id="minitest.current">current</h3>
<p align="center">
<code>MiniTest.current</code>
</p>
<p>Table with information about current state of test execution</p>
<p>Use it to examine result of <a href="../../mini.nvim/doc/mini-test.html#minitest.execute">MiniTest.execute()</a>. It is reset at the beginning of every call.</p>
<p>At least these keys are supported:</p>
<ul>
<li><p><span class="help-syntax-keys">&lt;all_cases&gt;</span> - array with all cases being currently executed. Basically, an input of <code>MiniTest.execute()</code>.</p></li>
<li><p><span class="help-syntax-keys">&lt;case&gt;</span> - currently executed test case. See <a href="../../mini.nvim/doc/mini-test.html#minitest-test-case">MiniTest-test-case</a>. Use it to customize execution output (like adding custom notes, etc).</p></li>
</ul>
<hr>
</section>
<section id="minitest.new_set" class="level3 help-syntax-right-anchor">
<h3 class="help-syntax-right-anchor anchored" data-anchor-id="minitest.new_set">new_set()</h3>
<p align="center">
<code>MiniTest.new_set</code>(<span class="help-syntax-special">{opts}</span>, <span class="help-syntax-special">{tbl}</span>)
</p>
<p>Create test set</p>
<p>Test set is one of the two fundamental data structures. It is a table that defines hierarchical test organization as opposed to sequential organization with <a href="../../mini.nvim/doc/mini-test.html#minitest-test-case">MiniTest-test-case</a>.</p>
<p>All its elements are one of three categories:</p>
<ul>
<li><p>A callable (object that can be called; function or table with <code>__call</code> metatble entry) is considered to define a test action. It will be called with “current arguments” (result of all nested <code>parametrize</code> values, read further). If it throws error, test has failed.</p></li>
<li><p>A test set (output of this function) defines nested structure. Its options during collection (see <a href="../../mini.nvim/doc/mini-test.html#minitest.collect">MiniTest.collect()</a>) will be extended with options of this (parent) test set.</p></li>
<li><p>Any other elements are considered helpers and don’t directly participate in test structure.</p></li>
</ul>
<p>Set options allow customization of test collection and execution (more details in <code>opts</code> description):</p>
<ul>
<li><p><code>hooks</code> - table with elements that will be called without arguments at predefined stages of test execution.</p></li>
<li><p><code>parametrize</code> - array defining different arguments with which main test actions will be called. Any non-trivial parametrization will lead to every element (even nested) be “multiplied” and processed with every element of <code>parametrize</code>. This allows handling many different combination of tests with little effort.</p></li>
<li><p><code>data</code> - table with user data that will be forwarded to cases. Primary objective is to be used for customized case filtering.</p></li>
</ul>
<p>Notes:</p>
<ul>
<li><p>Preferred way of adding elements is by using syntax <code>T[name] = element</code>. This way order of added elements will be preserved. Any other way won’t guarantee any order.</p></li>
<li><p>Supplied options <code>opts</code> are stored in <code>opts</code> field of metatable (<code>getmetatable(set).opts</code>).</p></li>
</ul>
<section id="minitest.new_set-parameters" class="level4">
<h4 class="anchored" data-anchor-id="minitest.new_set-parameters">Parameters</h4>
<p><span class="help-syntax-special">{opts}</span> <code>(table|nil)</code> Allowed options:</p>
<ul>
<li><p><span class="help-syntax-keys">&lt;hooks&gt;</span> - table with fields:</p>
<ul>
<li><p><span class="help-syntax-keys">&lt;pre_once&gt;</span> - executed before first filtered node.</p></li>
<li><p><span class="help-syntax-keys">&lt;pre_case&gt;</span> - executed before each case (even nested).</p></li>
<li><p><span class="help-syntax-keys">&lt;post_case&gt;</span> - executed after each case (even nested).</p></li>
<li><p><span class="help-syntax-keys">&lt;post_once&gt;</span> - executed after last filtered node.</p></li>
</ul></li>
<li><p><span class="help-syntax-keys">&lt;parametrize&gt;</span> - array where each element is itself an array of parameters to be appended to “current parameters” of callable fields. Note: don’t use plain <code>{}</code> as it is equivalent to “parametrization into zero cases”, so no cases will be collected from this set. Calling test actions with no parameters is equivalent to <code>{{}}</code> or not supplying <code>parametrize</code> option at all.</p></li>
<li><p><span class="help-syntax-keys">&lt;data&gt;</span> - user data to be forwarded to cases. Can be used for a more granular filtering.</p></li>
<li><p><span class="help-syntax-keys">&lt;n_retry&gt;</span> - number of times to retry each case until success. Default: 1.</p></li>
</ul>
<p><span class="help-syntax-special">{tbl}</span> <code>(table|nil)</code> Initial test items (possibly nested). Will be executed without any guarantees on order.</p>
</section>
<section id="minitest.new_set-return" class="level4">
<h4 class="anchored" data-anchor-id="minitest.new_set-return">Return</h4>
<p><code>(table)</code> A single test set.</p>
</section>
<section id="minitest.new_set-usage" class="level4">
<h4 class="anchored" data-anchor-id="minitest.new_set-usage">Usage</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="sourceCode lua code-with-copy"><code class="sourceCode lua"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Use with defaults</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="cn">T</span> <span class="op">=</span> <span class="va">MiniTest</span><span class="op">.</span>new_set<span class="op">()</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="cn">T</span><span class="op">[</span><span class="st">'works'</span><span class="op">]</span> <span class="op">=</span> <span class="kw">function</span><span class="op">()</span> <span class="va">MiniTest</span><span class="op">.</span><span class="va">expect</span><span class="op">.</span>equality<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">1</span><span class="op">)</span> <span class="kw">end</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co">-- Use with custom options. This will result into two actual cases: first</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">-- will pass, second - fail after two attempts.</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="cn">T</span><span class="op">[</span><span class="st">'nested'</span><span class="op">]</span> <span class="op">=</span> <span class="va">MiniTest</span><span class="op">.</span>new_set<span class="op">({</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="va">hooks</span> <span class="op">=</span> <span class="op">{</span> <span class="va">pre_case</span> <span class="op">=</span> <span class="kw">function</span><span class="op">()</span> <span class="cn">_G</span><span class="op">.</span><span class="va">x</span> <span class="op">=</span> <span class="dv">1</span> <span class="kw">end</span> <span class="op">},</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="va">parametrize</span> <span class="op">=</span> <span class="op">{</span> <span class="op">{</span> <span class="dv">1</span> <span class="op">},</span> <span class="op">{</span> <span class="dv">2</span> <span class="op">}</span> <span class="op">},</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="va">n_retry</span> <span class="op">=</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="op">})</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="cn">T</span><span class="op">[</span><span class="st">'nested'</span><span class="op">][</span><span class="st">'works'</span><span class="op">]</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">MiniTest</span><span class="op">.</span><span class="va">expect</span><span class="op">.</span>equality<span class="op">(</span><span class="cn">_G</span><span class="op">.</span><span class="va">x</span><span class="op">,</span> <span class="va">x</span><span class="op">)</span> <span class="kw">end</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
</section>
<section id="minitest-test-case" class="level3 help-syntax-right-anchor">
<h3 class="help-syntax-right-anchor anchored" data-anchor-id="minitest-test-case">Test case</h3>
<p>Test case</p>
<p>An item of sequential test organization, as opposed to hierarchical with test set (see <a href="../../mini.nvim/doc/mini-test.html#minitest.new_set">MiniTest.new_set()</a>). It is created as result of test collection with <a href="../../mini.nvim/doc/mini-test.html#minitest.collect">MiniTest.collect()</a> to represent all necessary information of test execution.</p>
<p>Execution of test case goes by the following rules:</p>
<ul>
<li><p>Call functions in order:</p>
<ul>
<li><p>All elements of <code>hooks.pre</code> from first to last without arguments.</p></li>
<li><p>Field <code>test</code> with arguments unpacked from <code>args</code>. If execution fails, retry it (along with hooks that come from <code>pre_case</code> and <code>post_case</code>) at most <code>n_retry</code> times until first success (if any).</p></li>
<li><p>All elements of <code>hooks.post</code> from first to last without arguments.</p></li>
</ul></li>
<li><p>Error in any call gets appended to <code>exec.fails</code>, meaning error in any hook will lead to test fail.</p></li>
<li><p>State (<code>exec.state</code>) is changed before every call and after last call.</p></li>
</ul>
<section id="minitest-test-case-class" class="level4">
<h4 class="anchored" data-anchor-id="minitest-test-case-class">Class</h4>
<p><span class="help-syntax-special">{Test-case}</span></p>
</section>
<section id="minitest-test-case-fields" class="level4">
<h4 class="anchored" data-anchor-id="minitest-test-case-fields">Fields</h4>
<p><span class="help-syntax-special">{args}</span> <code>(table)</code> Array of arguments with which <code>test</code> will be called.</p>
<p><span class="help-syntax-special">{data}</span> <code>(table)</code> User data: all fields of <code>opts.data</code> from nested test sets.</p>
<p><span class="help-syntax-special">{desc}</span> <code>(table)</code> Description: array of fields from nested test sets.</p>
<p><span class="help-syntax-special">{exec}</span> <code>(table|nil)</code> Information about test case execution. Value of <code>nil</code> means that this particular case was not (yet) executed. Has following fields:</p>
<ul>
<li><p><span class="help-syntax-keys">&lt;fails&gt;</span> - array of strings with failing information.</p></li>
<li><p><span class="help-syntax-keys">&lt;notes&gt;</span> - array of strings with non-failing information.</p></li>
<li><p><span class="help-syntax-keys">&lt;state&gt;</span> - state of test execution. One of:</p>
<ul>
<li><p>‘Executing <name of="" what="" is="" being="" executed="">’ (during execution).</name></p></li>
<li><p>‘Pass’ (no fails, no notes).</p></li>
<li><p>‘Pass with notes’ (no fails, some notes).</p></li>
<li><p>‘Fail’ (some fails, no notes).</p></li>
<li><p>‘Fail with notes’ (some fails, some notes).</p></li>
</ul></li>
</ul>
<p><span class="help-syntax-special">{hooks}</span> <code>(table)</code> Hooks to be executed as part of test case. Has fields:</p>
<ul>
<li><p><span class="help-syntax-keys">&lt;pre&gt;</span> and <span class="help-syntax-keys">&lt;post&gt;</span> - arrays of functions to be consecutively executed before and after every execution of <code>test</code>.</p></li>
<li><p><span class="help-syntax-keys">&lt;pre_source&gt;</span> and <span class="help-syntax-keys">&lt;post_source&gt;</span> - arrays of strings with sources of corresponding elements in <span class="help-syntax-keys">&lt;pre&gt;</span> and <span class="help-syntax-keys">&lt;post&gt;</span> arrays. Source is one of <code>"once"</code> (for <code>pre_once</code> and <code>post_once</code> hooks) and <code>"case"</code> (for <code>pre_case</code> and <code>post_case</code> hooks).</p></li>
</ul>
<p><span class="help-syntax-special">{test}</span> <code>(function|table)</code> Main callable object representing test action.</p>
<hr>
</section>
</section>
<section id="minitest.skip" class="level3 help-syntax-right-anchor">
<h3 class="help-syntax-right-anchor anchored" data-anchor-id="minitest.skip">skip()</h3>
<p align="center">
<code>MiniTest.skip</code>(<span class="help-syntax-special">{msg}</span>)
</p>
<p>Skip the rest of current case</p>
<p>Notes:</p>
<ul>
<li><p>When called inside test case, stops execution while adding message to notes.</p></li>
<li><p>When called inside <code>pre_case</code> hook, registers skip at the start of its test case. Calling in other hooks has no effect.</p></li>
<li><p>Currently implemented as a specially handled type of error.</p></li>
</ul>
<section id="minitest.skip-parameters" class="level4">
<h4 class="anchored" data-anchor-id="minitest.skip-parameters">Parameters</h4>
<p><span class="help-syntax-special">{msg}</span> <code>(string|nil)</code> Message to be added to current case notes.</p>
<hr>
</section>
</section>
<section id="minitest.add_note" class="level3 help-syntax-right-anchor">
<h3 class="help-syntax-right-anchor anchored" data-anchor-id="minitest.add_note">add_note()</h3>
<p align="center">
<code>MiniTest.add_note</code>(<span class="help-syntax-special">{msg}</span>)
</p>
<p>Add note to currently executed test case</p>
<p>Appends <code>msg</code> to <code>exec.notes</code> field of <code>case</code> in <a href="../../mini.nvim/doc/mini-test.html#minitest.current">MiniTest.current</a>.</p>
<section id="minitest.add_note-parameters" class="level4">
<h4 class="anchored" data-anchor-id="minitest.add_note-parameters">Parameters</h4>
<p><span class="help-syntax-special">{msg}</span> <code>(string)</code> Note to add.</p>
<hr>
</section>
</section>
<section id="minitest.finally" class="level3 help-syntax-right-anchor">
<h3 class="help-syntax-right-anchor anchored" data-anchor-id="minitest.finally">finally()</h3>
<p align="center">
<code>MiniTest.finally</code>(<span class="help-syntax-special">{f}</span>)
</p>
<p>Register callable execution after current callable</p>
<p>Can be used several times inside hooks and main test callable of test case.</p>
<section id="minitest.finally-parameters" class="level4">
<h4 class="anchored" data-anchor-id="minitest.finally-parameters">Parameters</h4>
<p><span class="help-syntax-special">{f}</span> <code>(function|table)</code> Callable to be executed after current callable is finished executing (regardless of whether it ended with error or not).</p>
<hr>
</section>
</section>
<section id="minitest.run" class="level3 help-syntax-right-anchor">
<h3 class="help-syntax-right-anchor anchored" data-anchor-id="minitest.run">run()</h3>
<p align="center">
<code>MiniTest.run</code>(<span class="help-syntax-special">{opts}</span>)
</p>
<p>Run tests</p>
<ul>
<li><p>Try executing project specific script at path <code>opts.script_path</code>. If successful (no errors), then stop.</p></li>
<li><p>Collect cases with <a href="../../mini.nvim/doc/mini-test.html#minitest.collect">MiniTest.collect()</a> and <code>opts.collect</code>.</p></li>
<li><p>Execute collected cases with <a href="../../mini.nvim/doc/mini-test.html#minitest.execute">MiniTest.execute()</a> and <code>opts.execute</code>.</p></li>
</ul>
<section id="minitest.run-parameters" class="level4">
<h4 class="anchored" data-anchor-id="minitest.run-parameters">Parameters</h4>
<p><span class="help-syntax-special">{opts}</span> <code>(table|nil)</code> Options with structure similar to <a href="../../mini.nvim/doc/mini-test.html#minitest.config">MiniTest.config</a>. Absent values are inferred from there.</p>
<hr>
</section>
</section>
<section id="minitest.run_file" class="level3 help-syntax-right-anchor">
<h3 class="help-syntax-right-anchor anchored" data-anchor-id="minitest.run_file">run_file()</h3>
<p align="center">
<code>MiniTest.run_file</code>(<span class="help-syntax-special">{file}</span>, <span class="help-syntax-special">{opts}</span>)
</p>
<p>Run specific test file</p>
<p>Basically a <a href="../../mini.nvim/doc/mini-test.html#minitest.run">MiniTest.run()</a> wrapper with custom <code>collect.find_files</code> option.</p>
<section id="minitest.run_file-parameters" class="level4">
<h4 class="anchored" data-anchor-id="minitest.run_file-parameters">Parameters</h4>
<p><span class="help-syntax-special">{file}</span> <code>(string|nil)</code> Path to test file. By default a path of current buffer.</p>
<p><span class="help-syntax-special">{opts}</span> <code>(table|nil)</code> Options for <a href="../../mini.nvim/doc/mini-test.html#minitest.run">MiniTest.run()</a>.</p>
<hr>
</section>
</section>
<section id="minitest.run_at_location" class="level3 help-syntax-right-anchor">
<h3 class="help-syntax-right-anchor anchored" data-anchor-id="minitest.run_at_location">run_at_location()</h3>
<p align="center">
<code>MiniTest.run_at_location</code>(<span class="help-syntax-special">{location}</span>, <span class="help-syntax-special">{opts}</span>)
</p>
<p>Run case(s) covering location</p>
<p>Try filtering case(s) covering location, meaning that definition of its main <code>test</code> action (as taken from builtin <code>debug.getinfo</code>) is located in specified file and covers specified line. Note that it can result in multiple cases if they come from parametrized test set (see <code>parametrize</code> option in <a href="../../mini.nvim/doc/mini-test.html#minitest.new_set">MiniTest.new_set()</a>).</p>
<p>Basically a <a href="../../mini.nvim/doc/mini-test.html#minitest.run">MiniTest.run()</a> wrapper with custom <code>collect.find_files</code> option.</p>
<section id="minitest.run_at_location-parameters" class="level4">
<h4 class="anchored" data-anchor-id="minitest.run_at_location-parameters">Parameters</h4>
<p><span class="help-syntax-special">{location}</span> <code>(table|nil)</code> Table with fields <span class="help-syntax-keys">&lt;file&gt;</span> (path to file) and <span class="help-syntax-keys">&lt;line&gt;</span> (line number in that file). Default is taken from current cursor position.</p>
<hr>
</section>
</section>
<section id="minitest.collect" class="level3 help-syntax-right-anchor">
<h3 class="help-syntax-right-anchor anchored" data-anchor-id="minitest.collect">collect()</h3>
<p align="center">
<code>MiniTest.collect</code>(<span class="help-syntax-special">{opts}</span>)
</p>
<p>Collect test cases</p>
<p>Overview of collection process:</p>
<ul>
<li><p>If <code>opts.emulate_busted</code> is <code>true</code>, temporary make special global functions (removed at the end of collection). They can be used inside test files to create hierarchical structure of test cases.</p></li>
<li><p>Source each file from array output of <code>opts.find_files</code>. It should output a test set (see <a href="../../mini.nvim/doc/mini-test.html#minitest.new_set">MiniTest.new_set()</a>) or <code>nil</code> (if “busted” style is used; test set is created implicitly).</p></li>
<li><p>Combine all test sets into single set with fields equal to its file path.</p></li>
<li><p>Convert from hierarchical test configuration to sequential: from single test set to array of test cases (see <a href="../../mini.nvim/doc/mini-test.html#minitest-test-case">MiniTest-test-case</a>). Conversion is done in the form of “for every table element do: for every <code>parametrize</code> element do: …”. Details:</p>
<ul>
<li><p>If element is a callable, construct test case with it being main <code>test</code> action. Description is appended with key of element in current test set table. Hooks, arguments, and data are taken from “current nested” ones. Add case to output array.</p></li>
<li><p>If element is a test set, process it in similar, recursive fashion. The “current nested” information is expanded:</p>
<ul>
<li><p><code>args</code> is extended with “current element” from <code>parametrize</code>.</p></li>
<li><p><code>desc</code> is appended with element key.</p></li>
<li><p><code>hooks</code> are appended to their appropriate places. <code>*_case</code> hooks will be inserted closer to all child cases than hooks from parent test sets: <code>pre_case</code> at end, <code>post_case</code> at start.</p></li>
<li><p><code>data</code> is extended via <a href="https://neovim.io/doc/user/helptag.html?tag=vim.tbl_deep_extend()">vim.tbl_deep_extend()</a>.</p></li>
</ul></li>
<li><p>Any other element is not processed.</p></li>
</ul></li>
<li><p>Filter array with <code>opts.filter_cases</code>. Note that input case doesn’t contain all hooks, as <code>*_once</code> hooks will be added after filtration.</p></li>
<li><p>Add <code>*_once</code> hooks to appropriate cases.</p></li>
</ul>
<section id="minitest.collect-parameters" class="level4">
<h4 class="anchored" data-anchor-id="minitest.collect-parameters">Parameters</h4>
<p><span class="help-syntax-special">{opts}</span> <code>(table|nil)</code> Options controlling case collection. Possible fields:</p>
<ul>
<li><p><span class="help-syntax-keys">&lt;emulate_busted&gt;</span> - whether to emulate ‘lunarmodules/busted’ interface. It emulates these global functions: <code>describe</code>, <code>it</code>, <code>setup</code>, <code>teardown</code>,</p>
<p align="center">
</p><p><code>before_each</code>, <code>after_each</code>. Use <a href="../../mini.nvim/doc/mini-test.html#minitest.skip">MiniTest.skip()</a> instead of <code>pending()</code></p>
<p></p>
<p>and <a href="../../mini.nvim/doc/mini-test.html#minitest.finally">MiniTest.finally()</a> instead of <code>finally</code>.</p></li>
<li><p><span class="help-syntax-keys">&lt;find_files&gt;</span> - function which when called without arguments returns array with file paths. Each file should be a Lua file returning single test set or <code>nil</code>.</p></li>
<li><p><span class="help-syntax-keys">&lt;filter_cases&gt;</span> - function which when called with single test case (see <a href="../../mini.nvim/doc/mini-test.html#minitest-test-case">MiniTest-test-case</a>) returns <code>false</code> if this case should be filtered out; <code>true</code> otherwise.</p></li>
</ul>
</section>
<section id="minitest.collect-return" class="level4">
<h4 class="anchored" data-anchor-id="minitest.collect-return">Return</h4>
<p><code>(table)</code> Array of test cases ready to be used by <a href="../../mini.nvim/doc/mini-test.html#minitest.execute">MiniTest.execute()</a>.</p>
<hr>
</section>
</section>
<section id="minitest.execute" class="level3 help-syntax-right-anchor">
<h3 class="help-syntax-right-anchor anchored" data-anchor-id="minitest.execute">execute()</h3>
<p align="center">
<code>MiniTest.execute</code>(<span class="help-syntax-special">{cases}</span>, <span class="help-syntax-special">{opts}</span>)
</p>
<p>Execute array of test cases</p>
<p>Overview of execution process:</p>
<ul>
<li><p>Reset <code>all_cases</code> in <a href="../../mini.nvim/doc/mini-test.html#minitest.current">MiniTest.current</a> with <code>cases</code> input.</p></li>
<li><p>Call <code>reporter.start(cases)</code> (if present).</p></li>
<li><p>Execute each case in natural array order (aligned with their integer keys). Set <code>MiniTest.current.case</code> to currently executed case. Detailed test case execution is described in <a href="../../mini.nvim/doc/mini-test.html#minitest-test-case">MiniTest-test-case</a>. After any state change (including case retry attempts), call <code>reporter.update(case_num)</code> (if present), where <code>case_num</code> is an integer key of current test case.</p></li>
<li><p>Call <code>reporter.finish()</code> (if present).</p></li>
</ul>
<p>Notes:</p>
<ul>
<li><p>Execution is done in asynchronous fashion with scheduling. This allows making meaningful progress report during execution.</p></li>
<li><p>This function doesn’t return anything. Instead, it updates <code>cases</code> in place with proper <code>exec</code> field. Use <code>all_cases</code> at <a href="../../mini.nvim/doc/mini-test.html#minitest.current">MiniTest.current</a> to look at execution result.</p></li>
</ul>
<section id="minitest.execute-parameters" class="level4">
<h4 class="anchored" data-anchor-id="minitest.execute-parameters">Parameters</h4>
<p><span class="help-syntax-special">{cases}</span> <code>(table)</code> Array of test cases (see <a href="../../mini.nvim/doc/mini-test.html#minitest-test-case">MiniTest-test-case</a>).</p>
<p><span class="help-syntax-special">{opts}</span> <code>(table|nil)</code> Options controlling case collection. Possible fields:</p>
<ul>
<li><p><span class="help-syntax-keys">&lt;reporter&gt;</span> - table with possible callable fields <code>start</code>, <code>update</code>, <code>finish</code>. Default: <a href="../../mini.nvim/doc/mini-test.html#minitest.gen_reporter.buffer">MiniTest.gen_reporter.buffer()</a> in interactive usage and <a href="../../mini.nvim/doc/mini-test.html#minitest.gen_reporter.stdout">MiniTest.gen_reporter.stdout()</a> in headless usage.</p></li>
<li><p><span class="help-syntax-keys">&lt;stop_on_error&gt;</span> - whether to stop execution (see <a href="../../mini.nvim/doc/mini-test.html#minitest.stop">MiniTest.stop()</a>) after first error. Default: <code>false</code>.</p></li>
</ul>
<hr>
</section>
</section>
<section id="minitest.stop" class="level3 help-syntax-right-anchor">
<h3 class="help-syntax-right-anchor anchored" data-anchor-id="minitest.stop">stop()</h3>
<p align="center">
<code>MiniTest.stop</code>(<span class="help-syntax-special">{opts}</span>)
</p>
<p>Stop test execution</p>
<section id="minitest.stop-parameters" class="level4">
<h4 class="anchored" data-anchor-id="minitest.stop-parameters">Parameters</h4>
<p><span class="help-syntax-special">{opts}</span> <code>(table|nil)</code> Options with fields:</p>
<ul>
<li><span class="help-syntax-keys">&lt;close_all_child_neovim&gt;</span> - whether to close all child neovim processes created with <a href="../../mini.nvim/doc/mini-test.html#minitest.new_child_neovim">MiniTest.new_child_neovim()</a>. Default: <code>true</code>.</li>
</ul>
<hr>
</section>
</section>
<section id="minitest.is_executing" class="level3 help-syntax-right-anchor">
<h3 class="help-syntax-right-anchor anchored" data-anchor-id="minitest.is_executing">is_executing()</h3>
<p align="center">
<code>MiniTest.is_executing</code>()
</p>
<p>Check if tests are being executed</p>
<section id="minitest.is_executing-return" class="level4">
<h4 class="anchored" data-anchor-id="minitest.is_executing-return">Return</h4>
<p><code>(boolean)</code></p>
<hr>
</section>
</section>
<section id="minitest.expect" class="level3 help-syntax-right-anchor">
<h3 class="help-syntax-right-anchor anchored" data-anchor-id="minitest.expect">expect</h3>
<p align="center">
<code>MiniTest.expect</code>
</p>
<p>Table with expectation functions</p>
<p>Each function has the following behavior:</p>
<ul>
<li><p>Silently returns <code>true</code> if expectation is fulfilled.</p></li>
<li><p>Throws an informative error with information helpful for debugging.</p></li>
</ul>
<p>Mostly designed to be used within ‘mini.test’ framework.</p>
<section id="minitest.expect-usage" class="level4">
<h4 class="anchored" data-anchor-id="minitest.expect-usage">Usage</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="sourceCode lua code-with-copy"><code class="sourceCode lua"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> <span class="va">x</span> <span class="op">=</span> <span class="dv">1</span> <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="va">MiniTest</span><span class="op">.</span><span class="va">expect</span><span class="op">.</span>equality<span class="op">(</span><span class="va">x</span><span class="op">,</span> <span class="dv">2</span><span class="op">)</span> <span class="co">-- passes</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="va">MiniTest</span><span class="op">.</span><span class="va">expect</span><span class="op">.</span>equality<span class="op">(</span><span class="va">x</span><span class="op">,</span> <span class="dv">1</span><span class="op">)</span> <span class="co">-- fails</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
</section>
<section id="minitest.expect.equality" class="level3 help-syntax-right-anchor">
<h3 class="help-syntax-right-anchor anchored" data-anchor-id="minitest.expect.equality">expect.equality()</h3>
<p align="center">
<code>MiniTest.expect.equality</code>(<span class="help-syntax-special">{left}</span>, <span class="help-syntax-special">{right}</span>)
</p>
<p>Expect equality of two objects</p>
<p>Equality is tested via <a href="https://neovim.io/doc/user/helptag.html?tag=vim.deep_equal()">vim.deep_equal()</a>.</p>
<section id="minitest.expect.equality-parameters" class="level4">
<h4 class="anchored" data-anchor-id="minitest.expect.equality-parameters">Parameters</h4>
<p><span class="help-syntax-special">{left}</span> <code>(any)</code> First object.</p>
<p><span class="help-syntax-special">{right}</span> <code>(any)</code> Second object.</p>
<hr>
</section>
</section>
<section id="minitest.expect.no_equality" class="level3 help-syntax-right-anchor">
<h3 class="help-syntax-right-anchor anchored" data-anchor-id="minitest.expect.no_equality">expect.no_equality()</h3>
<p align="center">
<code>MiniTest.expect.no_equality</code>(<span class="help-syntax-special">{left}</span>, <span class="help-syntax-special">{right}</span>)
</p>
<p>Expect no equality of two objects</p>
<p>Equality is tested via <a href="https://neovim.io/doc/user/helptag.html?tag=vim.deep_equal()">vim.deep_equal()</a>.</p>
<section id="minitest.expect.no_equality-parameters" class="level4">
<h4 class="anchored" data-anchor-id="minitest.expect.no_equality-parameters">Parameters</h4>
<p><span class="help-syntax-special">{left}</span> <code>(any)</code> First object.</p>
<p><span class="help-syntax-special">{right}</span> <code>(any)</code> Second object.</p>
<hr>
</section>
</section>
<section id="minitest.expect.error" class="level3 help-syntax-right-anchor">
<h3 class="help-syntax-right-anchor anchored" data-anchor-id="minitest.expect.error">expect.error()</h3>
<p align="center">
<code>MiniTest.expect.error</code>(<span class="help-syntax-special">{f}</span>, <span class="help-syntax-special">{pattern}</span>, <span class="help-syntax-special">{…}</span>)
</p>
<p>Expect function call to raise error</p>
<section id="minitest.expect.error-parameters" class="level4">
<h4 class="anchored" data-anchor-id="minitest.expect.error-parameters">Parameters</h4>
<p><span class="help-syntax-special">{f}</span> <code>(function|table)</code> Callable to be tested for raising error.</p>
<p><span class="help-syntax-special">{pattern}</span> <code>(string|nil)</code> Pattern which error message should match. Use <code>nil</code> or empty string to not test for pattern matching.</p>
<p><span class="help-syntax-special">{…}</span> <code>(any)</code> Extra arguments with which <code>f</code> will be called.</p>
<hr>
</section>
</section>
<section id="minitest.expect.no_error" class="level3 help-syntax-right-anchor">
<h3 class="help-syntax-right-anchor anchored" data-anchor-id="minitest.expect.no_error">expect.no_error()</h3>
<p align="center">
<code>MiniTest.expect.no_error</code>(<span class="help-syntax-special">{f}</span>, <span class="help-syntax-special">{…}</span>)
</p>
<p>Expect function call to not raise error</p>
<section id="minitest.expect.no_error-parameters" class="level4">
<h4 class="anchored" data-anchor-id="minitest.expect.no_error-parameters">Parameters</h4>
<p><span class="help-syntax-special">{f}</span> <code>(function|table)</code> Callable to be tested for raising error.</p>
<p><span class="help-syntax-special">{…}</span> <code>(any)</code> Extra arguments with which <code>f</code> will be called.</p>
<hr>
</section>
</section>
<section id="minitest.expect.reference_screenshot" class="level3 help-syntax-right-anchor">
<h3 class="help-syntax-right-anchor anchored" data-anchor-id="minitest.expect.reference_screenshot">expect.reference_screenshot()</h3>
<p align="center">
<code>MiniTest.expect.reference_screenshot</code>(<span class="help-syntax-special">{screenshot}</span>, <span class="help-syntax-special">{path}</span>, <span class="help-syntax-special">{opts}</span>)
</p>
<p>Expect equality to reference screenshot</p>
<section id="minitest.expect.reference_screenshot-parameters" class="level4">
<h4 class="anchored" data-anchor-id="minitest.expect.reference_screenshot-parameters">Parameters</h4>
<p><span class="help-syntax-special">{screenshot}</span> <code>(table|nil)</code> Array with screenshot information. Usually an output of <code>child.get_screenshot()</code> (see <a href="../../mini.nvim/doc/mini-test.html#minitest-child-neovim-get_screenshot">MiniTest-child-neovim-get_screenshot()</a>). If <code>nil</code>, expectation passed.</p>
<p><span class="help-syntax-special">{path}</span> <code>(string|nil)</code> Path to reference screenshot. If <code>nil</code>, constructed automatically in directory <code>opts.directory</code> from current case info and total number of times it was called inside current case. If there is no file at <code>path</code>, it is created with content of <code>screenshot</code>.</p>
<p><span class="help-syntax-special">{opts}</span> <code>(table|nil)</code> Options:</p>
<ul>
<li><p><span class="help-syntax-keys">&lt;force&gt;</span> <code>(boolean)</code> - whether to forcefully create reference screenshot. Temporary useful during test writing. Default: <code>false</code>.</p></li>
<li><p><span class="help-syntax-keys">&lt;ignore_text&gt;</span> <code>(boolean|table)</code> - whether to ignore all or some text lines. If <code>true</code> - ignore all, if number array - ignore text of those lines, if <code>false</code> - do not ignore any. Default: <code>false</code>.</p></li>
<li><p><span class="help-syntax-keys">&lt;ignore_attr&gt;</span> <code>(boolean|table)</code> - whether to ignore all or some attr lines. If <code>true</code> - ignore all, if number array - ignore attr of those lines, if <code>false</code> - do not ignore any. Default: <code>false</code>.</p></li>
<li><p><span class="help-syntax-keys">&lt;directory&gt;</span> <code>(string)</code> - directory where automatically constructed <code>path</code> is located. Default: “tests/screenshots”.</p></li>
</ul>
<hr>
</section>
</section>
<section id="minitest.new_expectation" class="level3 help-syntax-right-anchor">
<h3 class="help-syntax-right-anchor anchored" data-anchor-id="minitest.new_expectation">new_expectation()</h3>
<p align="center">
<code>MiniTest.new_expectation</code>(<span class="help-syntax-special">{subject}</span>, <span class="help-syntax-special">{predicate}</span>, <span class="help-syntax-special">{fail_context}</span>)
</p>
<p>Create new expectation function</p>
<p>Helper for writing custom functions with behavior similar to other methods of <a href="../../mini.nvim/doc/mini-test.html#minitest.expect">MiniTest.expect</a>.</p>
<section id="minitest.new_expectation-parameters" class="level4">
<h4 class="anchored" data-anchor-id="minitest.new_expectation-parameters">Parameters</h4>
<p><span class="help-syntax-special">{subject}</span> <code>(string|function|table)</code> Subject of expectation. If callable, called with expectation input arguments to produce string value.</p>
<p><span class="help-syntax-special">{predicate}</span> <code>(function|table)</code> Predicate callable. Called with expectation input arguments. Output <code>false</code> or <code>nil</code> means failed expectation.</p>
<p><span class="help-syntax-special">{fail_context}</span> <code>(string|function|table)</code> Information about fail. If callable, called with expectation input arguments to produce string value.</p>
</section>
<section id="minitest.new_expectation-return" class="level4">
<h4 class="anchored" data-anchor-id="minitest.new_expectation-return">Return</h4>
<p><code>(function)</code> Expectation function.</p>
</section>
<section id="minitest.new_expectation-usage" class="level4">
<h4 class="anchored" data-anchor-id="minitest.new_expectation-usage">Usage</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5"><pre class="sourceCode lua code-with-copy"><code class="sourceCode lua"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> <span class="va">expect_truthy</span> <span class="op">=</span> <span class="va">MiniTest</span><span class="op">.</span>new_expectation<span class="op">(</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">'truthy'</span><span class="op">,</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="cf">return</span> <span class="va">x</span> <span class="kw">end</span><span class="op">,</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="cf">return</span> <span class="st">'Object: '</span> <span class="op">..</span> <span class="va">vim</span><span class="op">.</span>inspect<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="kw">end</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
</section>
<section id="minitest.gen_reporter" class="level3 help-syntax-right-anchor">
<h3 class="help-syntax-right-anchor anchored" data-anchor-id="minitest.gen_reporter">gen_reporter</h3>
<p align="center">
<code>MiniTest.gen_reporter</code>
</p>
<p>Table with pre-configured report generators</p>
<p>Each element is a function which returns reporter - table with callable <code>start</code>, <code>update</code>, and <code>finish</code> fields.</p>
<hr>
</section>
<section id="minitest.gen_reporter.buffer" class="level3 help-syntax-right-anchor">
<h3 class="help-syntax-right-anchor anchored" data-anchor-id="minitest.gen_reporter.buffer">gen_reporter.buffer()</h3>
<p align="center">
<code>MiniTest.gen_reporter.buffer</code>(<span class="help-syntax-special">{opts}</span>)
</p>
<p>Generate buffer reporter</p>
<p>This is a default choice for interactive (not headless) usage. Opens a window with dedicated non-terminal buffer and updates it with throttled redraws.</p>
<p>Opened buffer has the following helpful Normal mode mappings:</p>
<ul>
<li><p><code>&lt;Esc&gt;</code> - stop test execution if executing (see <a href="../../mini.nvim/doc/mini-test.html#minitest.is_executing">MiniTest.is_executing()</a> and <a href="../../mini.nvim/doc/mini-test.html#minitest.stop">MiniTest.stop()</a>). Close window otherwise.</p></li>
<li><p><code>q</code> - same as <code>&lt;Esc&gt;</code> for convenience and compatibility.</p></li>
</ul>
<p>General idea:</p>
<ul>
<li><p>Group cases by concatenating first <code>opts.group_depth</code> elements of case description (<code>desc</code> field). Groups by collected files if using default values.</p></li>
<li><p>In <code>start()</code> show some stats to know how much is scheduled to be executed.</p></li>
<li><p>In <code>update()</code> show symbolic overview of current group and state of current case. Each symbol represents one case and its state:</p>
<ul>
<li><p><code>?</code> - case didn’t finish executing.</p></li>
<li><p><code>o</code> - pass.</p></li>
<li><p><code>O</code> - pass with notes.</p></li>
<li><p><code>x</code> - fail.</p></li>
<li><p><code>X</code> - fail with notes.</p></li>
</ul></li>
<li><p>In <code>finish()</code> show all fails and notes ordered by case.</p></li>
</ul>
<section id="minitest.gen_reporter.buffer-parameters" class="level4">
<h4 class="anchored" data-anchor-id="minitest.gen_reporter.buffer-parameters">Parameters</h4>
<p><span class="help-syntax-special">{opts}</span> <code>(table|nil)</code> Table with options. Used fields:</p>
<ul>
<li><p><span class="help-syntax-keys">&lt;group_depth&gt;</span> - number of first elements of case description (can be zero) used for grouping. Higher values mean higher granularity of output. Default: 1.</p></li>
<li><p><span class="help-syntax-keys">&lt;throttle_delay&gt;</span> - minimum number of milliseconds to wait between redrawing. Reduces screen flickering but not amount of computations. Default: 10.</p></li>
<li><p><span class="help-syntax-keys">&lt;window&gt;</span> - definition of window to open. Can take one of the forms:</p>
<ul>
<li><p>Callable. It is called expecting output to be target window id (current window is used if output is <code>nil</code>). Use this to open in “normal” window (like <code>function() vim.cmd('vsplit') end</code>).</p></li>
<li><p>Table. Used as <code>config</code> argument in <a href="https://neovim.io/doc/user/helptag.html?tag=nvim_open_win()">nvim_open_win()</a>. Default: table for centered floating window.</p></li>
</ul></li>
</ul>
<hr>
</section>
</section>
<section id="minitest.gen_reporter.stdout" class="level3 help-syntax-right-anchor">
<h3 class="help-syntax-right-anchor anchored" data-anchor-id="minitest.gen_reporter.stdout">gen_reporter.stdout()</h3>
<p align="center">
<code>MiniTest.gen_reporter.stdout</code>(<span class="help-syntax-special">{opts}</span>)
</p>
<p>Generate stdout reporter</p>
<p>This is a default choice for headless usage. Writes to <code>stdout</code>. Uses coloring ANSI escape sequences to make pretty and informative output (should work in most modern terminals and continuous integration providers).</p>
<p>It has same general idea as <a href="../../mini.nvim/doc/mini-test.html#minitest.gen_reporter.buffer">MiniTest.gen_reporter.buffer()</a> with slightly less output (it doesn’t overwrite previous text) to overcome typical terminal limitations.</p>
<section id="minitest.gen_reporter.stdout-parameters" class="level4">
<h4 class="anchored" data-anchor-id="minitest.gen_reporter.stdout-parameters">Parameters</h4>
<p><span class="help-syntax-special">{opts}</span> <code>(table|nil)</code> Table with options. Used fields:</p>
<ul>
<li><p><span class="help-syntax-keys">&lt;group_depth&gt;</span> - number of first elements of case description (can be zero) used for grouping. Higher values mean higher granularity of output. Default: 1.</p></li>
<li><p><span class="help-syntax-keys">&lt;quit_on_finish&gt;</span> - whether to quit after finishing test execution. Default: <code>true</code>.</p></li>
</ul>
<hr>
</section>
</section>
<section id="minitest.new_child_neovim" class="level3 help-syntax-right-anchor">
<h3 class="help-syntax-right-anchor anchored" data-anchor-id="minitest.new_child_neovim">new_child_neovim()</h3>
<p align="center">
<code>MiniTest.new_child_neovim</code>()
</p>
<p>Create child Neovim process</p>
<p>This creates an object designed to be a fundamental piece of ‘mini.test’ methodology. It can start/stop/restart a separate (child) Neovim process (headless, but fully functioning) together with convenience helpers to interact with it through <a href="https://neovim.io/doc/user/helptag.html?tag=RPC">RPC</a> messages.</p>
<p>For more information see <a href="../../mini.nvim/doc/mini-test.html#minitest-child-neovim">MiniTest-child-neovim</a>.</p>
<section id="minitest.new_child_neovim-return" class="level4">
<h4 class="anchored" data-anchor-id="minitest.new_child_neovim-return">Return</h4>
<p><code>(MiniTest.child)</code> Object of <a href="../../mini.nvim/doc/mini-test.html#minitest-child-neovim">MiniTest-child-neovim</a>.</p>
</section>
<section id="minitest.new_child_neovim-usage" class="level4">
<h4 class="anchored" data-anchor-id="minitest.new_child_neovim-usage">Usage</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6"><pre class="sourceCode lua code-with-copy"><code class="sourceCode lua"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Initiate</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> <span class="va">child</span> <span class="op">=</span> <span class="va">MiniTest</span><span class="op">.</span>new_child_neovim<span class="op">()</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="va">child</span><span class="op">.</span>start<span class="op">()</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">-- Use API functions</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="va">child</span><span class="op">.</span><span class="va">api</span><span class="op">.</span>nvim_buf_set_lines<span class="op">(</span><span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="op">-</span><span class="dv">1</span><span class="op">,</span> <span class="kw">true</span><span class="op">,</span> <span class="op">{</span> <span class="st">'Line inside child Neovim'</span> <span class="op">})</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co">-- Execute Lua code, Vimscript commands, etc.</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="va">child</span><span class="op">.</span>lua<span class="op">(</span><span class="st">'_G.n = 0'</span><span class="op">)</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="va">child</span><span class="op">.</span>cmd<span class="op">(</span><span class="st">'au CursorMoved * lua _G.n = _G.n + 1'</span><span class="op">)</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="va">child</span><span class="op">.</span>type_keys<span class="op">(</span><span class="st">'l'</span><span class="op">)</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span><span class="op">(</span><span class="va">child</span><span class="op">.</span>lua_get<span class="op">(</span><span class="st">'_G.n'</span><span class="op">))</span> <span class="co">-- Should be 1</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co">-- Use other `vim.xxx` Lua wrappers (executed inside child process)</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="va">vim</span><span class="op">.</span><span class="va">b</span><span class="op">.</span><span class="va">aaa</span> <span class="op">=</span> <span class="st">'current process'</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="va">child</span><span class="op">.</span><span class="va">b</span><span class="op">.</span><span class="va">aaa</span> <span class="op">=</span> <span class="st">'child process'</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span><span class="op">(</span><span class="va">child</span><span class="op">.</span>lua_get<span class="op">(</span><span class="st">'vim.b.aaa'</span><span class="op">))</span> <span class="co">-- Should be 'child process'</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="co">-- Always stop process after it is not needed</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="va">child</span><span class="op">.</span>stop<span class="op">()</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
</section>
<section id="minitest-child-neovim" class="level3 help-syntax-right-anchor">
<h3 class="help-syntax-right-anchor anchored" data-anchor-id="minitest-child-neovim">Child neovim</h3>
<p>Child class</p>
<p>It offers a great set of tools to write reliable and reproducible tests by allowing to use fresh process in any test action. Interaction with it is done through <a href="https://neovim.io/doc/user/helptag.html?tag=RPC">RPC</a> protocol.</p>
<p>Although quite flexible, at the moment it has certain limitations:</p>
<ul>
<li><p>Doesn’t allow using functions or userdata for child’s both inputs and outputs. Usual solution is to move computations from current Neovim process to child process. Use <code>child.lua()</code> and <code>child.lua_get()</code> for that.</p></li>
<li><p>When writing tests, it is common to end up with “hanging” process: it stops executing without any output. Most of the time it is because Neovim process is “blocked”, i.e.&nbsp;it waits for user input and won’t return from other call (like <code>child.api.nvim_exec_lua()</code>). Common causes are active <a href="https://neovim.io/doc/user/helptag.html?tag=hit-enter-prompt">hit-enter-prompt</a> (increase prompt height to a bigger value) or Operator-pending mode (exit it). To mitigate this experience, most helpers will throw an error if its immediate execution will lead to hanging state. Also in case of hanging state try <code>child.api_notify</code> instead of <code>child.api</code>.</p></li>
</ul>
<p>Notes:</p>
<ul>
<li><p>An important type of field is a “redirection table”. It acts as a convenience wrapper for corresponding <code>vim.*</code> table. Can be used both to return and set values. Examples:</p>
<ul>
<li><p><code>child.api.nvim_buf_line_count(0)</code> will execute <code>vim.api.nvim_buf_line_count(0)</code> inside child process and return its output to current process.</p></li>
<li><p><code>child.bo.filetype = 'lua'</code> will execute <code>vim.bo.filetype = 'lua'</code> inside child process. They still have same limitations listed above, so are not perfect. In case of a doubt, use <code>child.lua()</code>.</p></li>
</ul></li>
<li><p>Almost all methods use <a href="https://neovim.io/doc/user/helptag.html?tag=vim.rpcrequest()">vim.rpcrequest()</a> (i.e.&nbsp;wait for call to finish and then return value). See for <code>*_notify</code> variant to use <a href="https://neovim.io/doc/user/helptag.html?tag=vim.rpcnotify()">vim.rpcnotify()</a>.</p></li>
<li><p>All fields and methods should be called with <code>.</code>, not <code>:</code>.</p></li>
</ul>
<section id="minitest-child-neovim-class" class="level4">
<h4 class="anchored" data-anchor-id="minitest-child-neovim-class">Class</h4>
<p><span class="help-syntax-special">{MiniTest.child}</span></p>
</section>
<section id="minitest-child-neovim-fields" class="level4">
<h4 class="anchored" data-anchor-id="minitest-child-neovim-fields">Fields</h4>
<p><span class="help-syntax-special">{start}</span> <code>(function)</code> Start child process. See <a href="../../mini.nvim/doc/mini-test.html#minitest-child-neovim-start">MiniTest-child-neovim-start()</a>.</p>
<p><span class="help-syntax-special">{stop}</span> <code>(function)</code> Stop current child process.</p>
<p><span class="help-syntax-special">{restart}</span> <code>(function)</code> Restart child process: stop if running and then start a new one. Takes same arguments as <code>child.start()</code> but uses values from most recent <code>start()</code> call as defaults.</p>
<p><span class="help-syntax-special">{type_keys}</span> <code>(function)</code> Emulate typing keys. See <a href="../../mini.nvim/doc/mini-test.html#minitest-child-neovim-type_keys">MiniTest-child-neovim-type_keys()</a>. Doesn’t check for blocked state.</p>
<p><span class="help-syntax-special">{cmd}</span> <code>(function)</code> Execute Vimscript code from a string. A wrapper for <a href="https://neovim.io/doc/user/helptag.html?tag=nvim_exec()">nvim_exec()</a> without capturing output.</p>
<p><span class="help-syntax-special">{cmd_capture}</span> <code>(function)</code> Execute Vimscript code from a string and capture output. A wrapper for <a href="https://neovim.io/doc/user/helptag.html?tag=nvim_exec()">nvim_exec()</a> with capturing output.</p>
<p><span class="help-syntax-special">{lua}</span> <code>(function)</code> Execute Lua code. A wrapper for <a href="https://neovim.io/doc/user/helptag.html?tag=nvim_exec_lua()">nvim_exec_lua()</a>.</p>
<p><span class="help-syntax-special">{lua_notify}</span> <code>(function)</code> Execute Lua code without waiting for output.</p>
<p><span class="help-syntax-special">{lua_get}</span> <code>(function)</code> Execute Lua code and return result. A wrapper for <a href="https://neovim.io/doc/user/helptag.html?tag=nvim_exec_lua()">nvim_exec_lua()</a> but prepends string code with <code>return</code>.</p>
<p><span class="help-syntax-special">{lua_func}</span> <code>(function)</code> Execute Lua function and return it’s result. Function will be called with all extra parameters (second one and later). Note: usage of upvalues (data from outside function scope) is not allowed.</p>
<p><span class="help-syntax-special">{is_blocked}</span> <code>(function)</code> Check whether child process is blocked.</p>
<p><span class="help-syntax-special">{is_running}</span> <code>(function)</code> Check whether child process is currently running.</p>
<p><span class="help-syntax-special">{ensure_normal_mode}</span> <code>(function)</code> Ensure normal mode.</p>
<p><span class="help-syntax-special">{get_screenshot}</span> <code>(function)</code> Returns table with two “2d arrays” of single characters representing what is displayed on screen and how it looks. Has <code>opts</code> table argument for optional configuratnion.</p>
<p><span class="help-syntax-special">{job}</span> <code>(table|nil)</code> Information about current job. If <code>nil</code>, child is not running.</p>
<p><span class="help-syntax-special">{api}</span> <code>(table)</code> Redirection table for <code>vim.api</code>. Doesn’t check for blocked state.</p>
<p><span class="help-syntax-special">{api_notify}</span> <code>(table)</code> Same as <code>api</code>, but uses <a href="https://neovim.io/doc/user/helptag.html?tag=vim.rpcnotify()">vim.rpcnotify()</a>.</p>
<p><span class="help-syntax-special">{diagnostic}</span> <code>(table)</code> Redirection table for <a href="https://neovim.io/doc/user/helptag.html?tag=vim.diagnostic">vim.diagnostic</a>.</p>
<p><span class="help-syntax-special">{fn}</span> <code>(table)</code> Redirection table for <a href="https://neovim.io/doc/user/helptag.html?tag=vim.fn">vim.fn</a>.</p>
<p><span class="help-syntax-special">{highlight}</span> <code>(table)</code> Redirection table for <a href="https://neovim.io/doc/user/helptag.html?tag=vim.highlight">vim.highlight</a>.</p>
<p><span class="help-syntax-special">{hl}</span> <code>(table)</code> Redirection table for <a href="https://neovim.io/doc/user/helptag.html?tag=vim.hl">vim.hl</a>.</p>
<p><span class="help-syntax-special">{json}</span> <code>(table)</code> Redirection table for <code>vim.json</code>.</p>
<p><span class="help-syntax-special">{loop}</span> <code>(table)</code> Redirection table for <a href="https://neovim.io/doc/user/helptag.html?tag=vim.loop">vim.loop</a>.</p>
<p><span class="help-syntax-special">{lsp}</span> <code>(table)</code> Redirection table for <code>vim.lsp</code> (<a href="https://neovim.io/doc/user/helptag.html?tag=lsp-core">lsp-core</a>).</p>
<p><span class="help-syntax-special">{mpack}</span> <code>(table)</code> Redirection table for <a href="https://neovim.io/doc/user/helptag.html?tag=vim.mpack">vim.mpack</a>.</p>
<p><span class="help-syntax-special">{spell}</span> <code>(table)</code> Redirection table for <a href="https://neovim.io/doc/user/helptag.html?tag=vim.spell">vim.spell</a>.</p>
<p><span class="help-syntax-special">{treesitter}</span> <code>(table)</code> Redirection table for <code>vim.treesitter</code> (<a href="https://neovim.io/doc/user/helptag.html?tag=lua-treesitter-core">lua-treesitter-core</a>).</p>
<p><span class="help-syntax-special">{ui}</span> <code>(table)</code> Redirection table for <a href="https://neovim.io/doc/user/helptag.html?tag=vim.ui">vim.ui</a>. Currently of no use because it requires sending function through RPC, which is impossible at the moment.</p>
<p><span class="help-syntax-special">{fs}</span> <code>(table)</code> Redirection table for <a href="https://neovim.io/doc/user/helptag.html?tag=vim.fs">vim.fs</a>.</p>
<p><span class="help-syntax-special">{g}</span> <code>(table)</code> Redirection table for <a href="https://neovim.io/doc/user/helptag.html?tag=vim.g">vim.g</a>.</p>
<p><span class="help-syntax-special">{b}</span> <code>(table)</code> Redirection table for <a href="https://neovim.io/doc/user/helptag.html?tag=vim.b">vim.b</a>.</p>
<p><span class="help-syntax-special">{w}</span> <code>(table)</code> Redirection table for <a href="https://neovim.io/doc/user/helptag.html?tag=vim.w">vim.w</a>.</p>
<p><span class="help-syntax-special">{t}</span> <code>(table)</code> Redirection table for <a href="https://neovim.io/doc/user/helptag.html?tag=vim.t">vim.t</a>.</p>
<p><span class="help-syntax-special">{v}</span> <code>(table)</code> Redirection table for <a href="https://neovim.io/doc/user/helptag.html?tag=vim.v">vim.v</a>.</p>
<p><span class="help-syntax-special">{env}</span> <code>(table)</code> Redirection table for <a href="https://neovim.io/doc/user/helptag.html?tag=vim.env">vim.env</a>.</p>
<p><span class="help-syntax-special">{o}</span> <code>(table)</code> Redirection table for <a href="https://neovim.io/doc/user/helptag.html?tag=vim.o">vim.o</a>.</p>
<p><span class="help-syntax-special">{go}</span> <code>(table)</code> Redirection table for <a href="https://neovim.io/doc/user/helptag.html?tag=vim.go">vim.go</a>.</p>
<p><span class="help-syntax-special">{bo}</span> <code>(table)</code> Redirection table for <a href="https://neovim.io/doc/user/helptag.html?tag=vim.bo">vim.bo</a>.</p>
<p><span class="help-syntax-special">{wo}</span> <code>(table)</code> Redirection table for <a href="https://neovim.io/doc/user/helptag.html?tag=vim.wo">vim.wo</a>.</p>
<hr>
</section>
</section>
<section id="minitest-child-neovim-start" class="level3 help-syntax-right-anchor">
<h3 class="help-syntax-right-anchor anchored" data-anchor-id="minitest-child-neovim-start">Child neovim start()</h3>
<p align="center">
<code>child.start</code>(<span class="help-syntax-special">{args}</span>, <span class="help-syntax-special">{opts}</span>)
</p>
<p>Start child process and connect to it. Won’t work if child is already running.</p>
<section id="minitest-child-neovim-start-parameters" class="level4">
<h4 class="anchored" data-anchor-id="minitest-child-neovim-start-parameters">Parameters</h4>
<p><span class="help-syntax-special">{args}</span> <code>(table)</code> Array with arguments for executable. Will be prepended with the following default arguments (see <a href="https://neovim.io/doc/user/helptag.html?tag=startup-options">startup-options</a>):</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7"><pre class="sourceCode lua code-with-copy"><code class="sourceCode lua"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="op">{</span> <span class="st">'--clean'</span><span class="op">,</span> <span class="st">'-n'</span><span class="op">,</span> <span class="st">'--listen'</span><span class="op">,</span> <span class="op">&lt;</span><span class="va">some</span> <span class="va">address</span><span class="op">&gt;,</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">'--headless'</span><span class="op">,</span> <span class="st">'--cmd'</span><span class="op">,</span> <span class="st">'set lines=24 columns=80'</span> <span class="op">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><span class="help-syntax-special">{opts}</span> <code>(table|nil)</code> Options:</p>
<ul>
<li><p><span class="help-syntax-keys">&lt;nvim_executable&gt;</span> - name of Neovim executable. Default: <a href="https://neovim.io/doc/user/helptag.html?tag=v:progpath">v:progpath</a>.</p></li>
<li><p><span class="help-syntax-keys">&lt;connection_timeout&gt;</span> - stop trying to connect after this amount of milliseconds. Default: 5000.</p></li>
</ul>
</section>
<section id="minitest-child-neovim-start-usage" class="level4">
<h4 class="anchored" data-anchor-id="minitest-child-neovim-start-usage">Usage</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8"><pre class="sourceCode lua code-with-copy"><code class="sourceCode lua"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="va">child</span> <span class="op">=</span> <span class="va">MiniTest</span><span class="op">.</span>new_child_neovim<span class="op">()</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co">-- Start default clean Neovim instance</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="va">child</span><span class="op">.</span>start<span class="op">()</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co">-- Start with custom 'init.lua' file</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="va">child</span><span class="op">.</span>start<span class="op">({</span> <span class="st">'-u'</span><span class="op">,</span> <span class="st">'scripts/minimal_init.lua'</span> <span class="op">})</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
</section>
<section id="minitest-child-neovim-type_keys" class="level3 help-syntax-right-anchor">
<h3 class="help-syntax-right-anchor anchored" data-anchor-id="minitest-child-neovim-type_keys">Child neovim type_keys()</h3>
<p align="center">
<code>child.type_keys</code>(<span class="help-syntax-special">{wait}</span>, <span class="help-syntax-special">{…}</span>)
</p>
<p>Basically a wrapper for <a href="https://neovim.io/doc/user/helptag.html?tag=nvim_input()">nvim_input()</a> applied inside child process. Differences:</p>
<ul>
<li><p>Can wait after each group of characters.</p></li>
<li><p>Raises error if typing keys resulted into error in child process (i.e.&nbsp;its <a href="https://neovim.io/doc/user/helptag.html?tag=v:errmsg">v:errmsg</a> was updated).</p></li>
<li><p>Key ‘&lt;’ as separate entry may not be escaped as ‘<span class="help-syntax-keys">&lt;LT&gt;</span>’.</p></li>
</ul>
<section id="minitest-child-neovim-type_keys-parameters" class="level4">
<h4 class="anchored" data-anchor-id="minitest-child-neovim-type_keys-parameters">Parameters</h4>
<p><span class="help-syntax-special">{wait}</span> <code>(number|nil)</code> Number of milliseconds to wait after each entry. May be omitted, in which case no waiting is done.</p>
<p><span class="help-syntax-special">{…}</span> <code>(string|table&lt;number,string&gt;)</code> Separate entries for <a href="https://neovim.io/doc/user/helptag.html?tag=nvim_input()">nvim_input()</a>, after which <code>wait</code> will be applied. Can be either string or array of strings.</p>
</section>
<section id="minitest-child-neovim-type_keys-usage" class="level4">
<h4 class="anchored" data-anchor-id="minitest-child-neovim-type_keys-usage">Usage</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9"><pre class="sourceCode lua code-with-copy"><code class="sourceCode lua"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- All of these type keys 'c', 'a', 'w'</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="va">child</span><span class="op">.</span>type_keys<span class="op">(</span><span class="st">'caw'</span><span class="op">)</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="va">child</span><span class="op">.</span>type_keys<span class="op">(</span><span class="st">'c'</span><span class="op">,</span> <span class="st">'a'</span><span class="op">,</span> <span class="st">'w'</span><span class="op">)</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="va">child</span><span class="op">.</span>type_keys<span class="op">(</span><span class="st">'c'</span><span class="op">,</span> <span class="op">{</span> <span class="st">'a'</span><span class="op">,</span> <span class="st">'w'</span> <span class="op">})</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co">-- Waits 5 ms after `c` and after 'w'</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="va">child</span><span class="op">.</span>type_keys<span class="op">(</span><span class="dv">5</span><span class="op">,</span> <span class="st">'c'</span><span class="op">,</span> <span class="op">{</span> <span class="st">'a'</span><span class="op">,</span> <span class="st">'w'</span> <span class="op">})</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co">-- Special keys can also be used</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="va">child</span><span class="op">.</span>type_keys<span class="op">(</span><span class="st">'i'</span><span class="op">,</span> <span class="st">'Hello world'</span><span class="op">,</span> <span class="st">'&lt;Esc&gt;'</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
</section>
<section id="minitest-child-neovim-get_screenshot" class="level3 help-syntax-right-anchor">
<h3 class="help-syntax-right-anchor anchored" data-anchor-id="minitest-child-neovim-get_screenshot">Child neovim get_screenshot()</h3>
<p align="center">
<code>child.get_screenshot</code>(<span class="help-syntax-special">{opts}</span>)
</p>
<p>Compute what is displayed on (default TUI) screen and how it is displayed. This basically calls <a href="https://neovim.io/doc/user/helptag.html?tag=screenstring()">screenstring()</a> and <a href="https://neovim.io/doc/user/helptag.html?tag=screenattr()">screenattr()</a> for every visible cell (row from 1 to ‘lines’, column from 1 to ‘columns’).</p>
<p>Notes:</p>
<ul>
<li>To make output more portable and visually useful, outputs of <code>screenattr()</code> are coded with single character symbols. Those are taken from 94 characters (ASCII codes between 33 and 126), so there will be duplicates in case of more than 94 different ways text is displayed on screen.</li>
</ul>
<section id="minitest-child-neovim-get_screenshot-parameters" class="level4">
<h4 class="anchored" data-anchor-id="minitest-child-neovim-get_screenshot-parameters">Parameters</h4>
<p><span class="help-syntax-special">{opts}</span> <code>(table|nil)</code> Options. Possieble fields:</p>
<ul>
<li><span class="help-syntax-keys">&lt;redraw&gt;</span> <code>(boolean)</code> - whether to call <a href="https://neovim.io/doc/user/helptag.html?tag=:redraw">:redraw</a> prior to computing screenshot. Default: <code>true</code>.</li>
</ul>
</section>
<section id="minitest-child-neovim-get_screenshot-return" class="level4">
<h4 class="anchored" data-anchor-id="minitest-child-neovim-get_screenshot-return">Return</h4>
<p><code>(table|nil)</code> Screenshot table with the following fields:</p>
<ul>
<li><p><span class="help-syntax-keys">&lt;text&gt;</span> - “2d array” (row-column) of single characters displayed at particular cells.</p></li>
<li><p><span class="help-syntax-keys">&lt;attr&gt;</span> - “2d array” (row-column) of symbols representing how text is displayed (basically, “coded” appearance/highlighting). They should be used only in relation to each other: same/different symbols for two cells mean same/different visual appearance. Note: there will be false positives if there are more than 94 different attribute values. It also can be used with <code>tostring()</code> to convert to single string (used for writing to reference file). It results into two visual parts (separated by empty line), for <code>text</code> and <code>attr</code>. Each part has “ruler” above content and line numbers for each line. Returns <code>nil</code> if couldn’t get a reasonable screenshot.</p></li>
</ul>
</section>
<section id="minitest-child-neovim-get_screenshot-usage" class="level4">
<h4 class="anchored" data-anchor-id="minitest-child-neovim-get_screenshot-usage">Usage</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10"><pre class="sourceCode lua code-with-copy"><code class="sourceCode lua"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> <span class="va">screenshot</span> <span class="op">=</span> <span class="va">child</span><span class="op">.</span>get_screenshot<span class="op">()</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co">-- Show character displayed row=3 and column=4</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span><span class="op">(</span><span class="va">screenshot</span><span class="op">.</span><span class="va">text</span><span class="op">[</span><span class="dv">3</span><span class="op">][</span><span class="dv">4</span><span class="op">])</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">-- Convert to string</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="fu">tostring</span><span class="op">(</span><span class="va">screenshot</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>


</section>
</section>

</main> <!-- /main -->
<!-- Original source: https://gc.zgo.at/count.js -->
<!-- Inlined for security reasons (less supply chain attack possibility) -->
<script data-goatcounter="https://nvim-mini.goatcounter.com/count">
// GoatCounter: https://www.goatcounter.com
// This file is released under the ISC license: https://opensource.org/licenses/ISC
;(function() {
	'use strict';

	window.goatcounter = window.goatcounter || {}

	// Load settings from data-goatcounter-settings.
	var s = document.querySelector('script[data-goatcounter]')
	if (s && s.dataset.goatcounterSettings) {
		try         { var set = JSON.parse(s.dataset.goatcounterSettings) }
		catch (err) { console.error('invalid JSON in data-goatcounter-settings: ' + err) }
		for (var k in set)
			if (['no_onload', 'no_events', 'allow_local', 'allow_frame', 'path', 'title', 'referrer', 'event'].indexOf(k) > -1)
				window.goatcounter[k] = set[k]
	}

	var enc = encodeURIComponent

	// Get all data we're going to send off to the counter endpoint.
	window.goatcounter.get_data = function(vars) {
		vars = vars || {}
		var data = {
			p: (vars.path     === undefined ? goatcounter.path     : vars.path),
			r: (vars.referrer === undefined ? goatcounter.referrer : vars.referrer),
			t: (vars.title    === undefined ? goatcounter.title    : vars.title),
			e: !!(vars.event || goatcounter.event),
			s: window.screen.width,
			b: is_bot(),
			q: location.search,
		}

		var rcb, pcb, tcb  // Save callbacks to apply later.
		if (typeof(data.r) === 'function') rcb = data.r
		if (typeof(data.t) === 'function') tcb = data.t
		if (typeof(data.p) === 'function') pcb = data.p

		if (is_empty(data.r)) data.r = document.referrer
		if (is_empty(data.t)) data.t = document.title
		if (is_empty(data.p)) data.p = get_path()

		if (rcb) data.r = rcb(data.r)
		if (tcb) data.t = tcb(data.t)
		if (pcb) data.p = pcb(data.p)
		return data
	}

	// Check if a value is "empty" for the purpose of get_data().
	var is_empty = function(v) { return v === null || v === undefined || typeof(v) === 'function' }

	// See if this looks like a bot; there is some additional filtering on the
	// backend, but these properties can't be fetched from there.
	var is_bot = function() {
		// Headless browsers are probably a bot.
		var w = window, d = document
		if (w.callPhantom || w._phantom || w.phantom)
			return 150
		if (w.__nightmare)
			return 151
		if (d.__selenium_unwrapped || d.__webdriver_evaluate || d.__driver_evaluate)
			return 152
		if (navigator.webdriver)
			return 153
		return 0
	}

	// Object to urlencoded string, starting with a ?.
	var urlencode = function(obj) {
		var p = []
		for (var k in obj)
			if (obj[k] !== '' && obj[k] !== null && obj[k] !== undefined && obj[k] !== false)
				p.push(enc(k) + '=' + enc(obj[k]))
		return '?' + p.join('&')
	}

	// Show a warning in the console.
	var warn = function(msg) {
		if (console && 'warn' in console)
			console.warn('goatcounter: ' + msg)
	}

	// Get the endpoint to send requests to.
	var get_endpoint = function() {
		var s = document.querySelector('script[data-goatcounter]')
		return (s && s.dataset.goatcounter) ? s.dataset.goatcounter : goatcounter.endpoint
	}

	// Get current path.
	var get_path = function() {
		var loc = location,
			c = document.querySelector('link[rel="canonical"][href]')
		if (c) {  // May be relative or point to different domain.
			var a = document.createElement('a')
			a.href = c.href
			if (a.hostname.replace(/^www\./, '') === location.hostname.replace(/^www\./, ''))
				loc = a
		}
		return (loc.pathname + loc.search) || '/'
	}

	// Run function after DOM is loaded.
	var on_load = function(f) {
		if (document.body === null)
			document.addEventListener('DOMContentLoaded', function() { f() }, false)
		else
			f()
	}

	// Filter some requests that we (probably) don't want to count.
	window.goatcounter.filter = function() {
		if ('visibilityState' in document && document.visibilityState === 'prerender')
			return 'visibilityState'
		if (!goatcounter.allow_frame && location !== parent.location)
			return 'frame'
		if (!goatcounter.allow_local && location.hostname.match(/(localhost$|^127\.|^10\.|^172\.(1[6-9]|2[0-9]|3[0-1])\.|^192\.168\.|^0\.0\.0\.0$)/))
			return 'localhost'
		if (!goatcounter.allow_local && location.protocol === 'file:')
			return 'localfile'
		if (localStorage && localStorage.getItem('skipgc') === 't')
			return 'disabled with #toggle-goatcounter'
		return false
	}

	// Get URL to send to GoatCounter.
	window.goatcounter.url = function(vars) {
		var data = window.goatcounter.get_data(vars || {})
		if (data.p === null)  // null from user callback.
			return
		data.rnd = Math.random().toString(36).substr(2, 5)  // Browsers don't always listen to Cache-Control.

		var endpoint = get_endpoint()
		if (!endpoint)
			return warn('no endpoint found')

		return endpoint + urlencode(data)
	}

	// Count a hit.
	window.goatcounter.count = function(vars) {
		var f = goatcounter.filter()
		if (f)
			return warn('not counting because of: ' + f)
		var url = goatcounter.url(vars)
		if (!url)
			return warn('not counting because path callback returned null')

		if (!navigator.sendBeacon(url)) {
			// This mostly fails due to being blocked by CSP; try again with an
			// image-based fallback.
			var img = document.createElement('img')
			img.src = url
			img.style.position = 'absolute'  // Affect layout less.
			img.style.bottom = '0px'
			img.style.width = '1px'
			img.style.height = '1px'
			img.loading = 'eager'
			img.setAttribute('alt', '')
			img.setAttribute('aria-hidden', 'true')

			var rm = function() { if (img && img.parentNode) img.parentNode.removeChild(img) }
			img.addEventListener('load', rm, false)
			document.body.appendChild(img)
		}
	}

	// Get a query parameter.
	window.goatcounter.get_query = function(name) {
		var s = location.search.substr(1).split('&')
		for (var i = 0; i < s.length; i++)
			if (s[i].toLowerCase().indexOf(name.toLowerCase() + '=') === 0)
				return s[i].substr(name.length + 1)
	}

	// Track click events.
	window.goatcounter.bind_events = function() {
		if (!document.querySelectorAll)  // Just in case someone uses an ancient browser.
			return

		var send = function(elem) {
			return function() {
				goatcounter.count({
					event:    true,
					path:     (elem.dataset.goatcounterClick || elem.name || elem.id || ''),
					title:    (elem.dataset.goatcounterTitle || elem.title || (elem.innerHTML || '').substr(0, 200) || ''),
					referrer: (elem.dataset.goatcounterReferrer || elem.dataset.goatcounterReferral || ''),
				})
			}
		}

		Array.prototype.slice.call(document.querySelectorAll("*[data-goatcounter-click]")).forEach(function(elem) {
			if (elem.dataset.goatcounterBound)
				return
			var f = send(elem)
			elem.addEventListener('click', f, false)
			elem.addEventListener('auxclick', f, false)  // Middle click.
			elem.dataset.goatcounterBound = 'true'
		})
	}

	// Add a "visitor counter" frame or image.
	window.goatcounter.visit_count = function(opt) {
		on_load(function() {
			opt        = opt        || {}
			opt.type   = opt.type   || 'html'
			opt.append = opt.append || 'body'
			opt.path   = opt.path   || get_path()
			opt.attr   = opt.attr   || {width: '200', height: (opt.no_branding ? '60' : '80')}

			opt.attr['src'] = get_endpoint() + 'er/' + enc(opt.path) + '.' + enc(opt.type) + '?'
			if (opt.no_branding) opt.attr['src'] += '&no_branding=1'
			if (opt.style)       opt.attr['src'] += '&style=' + enc(opt.style)
			if (opt.start)       opt.attr['src'] += '&start=' + enc(opt.start)
			if (opt.end)         opt.attr['src'] += '&end='   + enc(opt.end)

			var tag = {png: 'img', svg: 'img', html: 'iframe'}[opt.type]
			if (!tag)
				return warn('visit_count: unknown type: ' + opt.type)

			if (opt.type === 'html') {
				opt.attr['frameborder'] = '0'
				opt.attr['scrolling']   = 'no'
			}

			var d = document.createElement(tag)
			for (var k in opt.attr)
				d.setAttribute(k, opt.attr[k])

			var p = document.querySelector(opt.append)
			if (!p)
				return warn('visit_count: element to append to not found: ' + opt.append)
			p.appendChild(d)
		})
	}

	// Make it easy to skip your own views.
	if (location.hash === '#toggle-goatcounter') {
		if (localStorage.getItem('skipgc') === 't') {
			localStorage.removeItem('skipgc', 't')
			alert('GoatCounter tracking is now ENABLED in this browser.')
		}
		else {
			localStorage.setItem('skipgc', 't')
			alert('GoatCounter tracking is now DISABLED in this browser until ' + location + ' is loaded again.')
		}
	}

	if (!goatcounter.no_onload)
		on_load(function() {
			// 1. Page is visible, count request.
			// 2. Page is not yet visible; wait until it switches to 'visible' and count.
			// See #487
			if (!('visibilityState' in document) || document.visibilityState === 'visible')
				goatcounter.count()
			else {
				var f = function(e) {
					if (document.visibilityState !== 'visible')
						return
					document.removeEventListener('visibilitychange', f)
					goatcounter.count()
				}
				document.addEventListener('visibilitychange', f)
			}

			if (!goatcounter.no_events)
				goatcounter.bind_events()
		})
})();
</script>
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/nvim-mini\.org");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>© Evgeni Chasnovski, <a href="https://choosealicense.com/licenses/mit/">MIT</a></p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>